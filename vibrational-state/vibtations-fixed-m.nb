(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.4' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    146469,       3433]
NotebookOptionsPosition[    144583,       3372]
NotebookOutlinePosition[    144971,       3389]
CellTagsIndexPosition[    144928,       3386]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"c", "[", 
    RowBox[{"n_", ",", "m_"}], "]"}], ":=", 
   RowBox[{"Binomial", "[", 
    RowBox[{"n", ",", "m"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"comb", "[", 
    RowBox[{"N_", ",", "k_"}], "]"}], ":=", 
   RowBox[{"Subsets", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{"i", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "N"}], "}"}]}], "]"}], ",", 
     RowBox[{"{", "k", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Num", "[", "x_", "]"}], ":=", 
    RowBox[{"N", "[", "x", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"HgMap", "[", 
     RowBox[{"N_", ",", "k_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "tab", ",", "ind1", ",", "listi", ",", "tabx", ",", "sites", ",", 
        "flipsites", ",", "set1", ",", "flip", ",", "listf", ",", "xb", ",", 
        "xa"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"tab", "=", 
        RowBox[{"{", "}"}]}], ";", 
       RowBox[{"tabx", "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"listi", "=", 
        RowBox[{"comb", "[", 
         RowBox[{"N", ",", "k"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"sites", "=", 
        RowBox[{"Table", "[", 
         RowBox[{"i", ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "N"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"set1", "=", 
           RowBox[{"listi", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"flipsites", "=", 
           RowBox[{"Complement", "[", 
            RowBox[{"sites", ",", "set1"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Do", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"flip", "=", 
              RowBox[{"flipsites", "[", 
               RowBox[{"[", "j", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"listf", "=", 
              RowBox[{"Sort", "[", 
               RowBox[{"Join", "[", 
                RowBox[{"set1", ",", 
                 RowBox[{"{", "flip", "}"}]}], "]"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"xa", "=", 
              RowBox[{
               RowBox[{"c", "[", 
                RowBox[{"N", ",", 
                 RowBox[{"k", "+", "1"}]}], "]"}], "-", 
               RowBox[{"Sum", "[", 
                RowBox[{
                 RowBox[{"c", "[", 
                  RowBox[{
                   RowBox[{"N", "-", 
                    RowBox[{"listf", "[", 
                    RowBox[{"[", 
                    RowBox[{"p", "+", "1"}], "]"}], "]"}]}], ",", 
                   RowBox[{"k", "+", "1", "-", "p"}]}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"p", ",", "0", ",", "k"}], "}"}]}], "]"}]}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"AppendTo", "[", 
              RowBox[{"tabx", ",", "xa"}], "]"}], ";"}], 
            "\[IndentingNewLine]", ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", "1", ",", 
              RowBox[{"Length", "[", "flipsites", "]"}]}], "}"}]}], "]"}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"tab", ",", "tabx"}], "]"}], ";", 
          RowBox[{"tabx", "=", 
           RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "listi", "]"}]}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "tab"}]}], "]"}]}], " ", ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"mkHg", "[", 
     RowBox[{"N_", ",", "m_", ",", "gg_"}], "]"}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "pntr", ",", "ind1", ",", "ind2", ",", "coora", ",", "ntot", ",", "Hg",
         ",", "ind2sub", ",", "m1"}], "}"}], ",", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "seperate", " ", "case", " ", "with", " ", "saturated", " ", 
        "polarisation"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"m1", "=", 
        RowBox[{"Min", "[", 
         RowBox[{"m", ",", "N"}], "]"}]}], ";", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"m", "\[LessEqual]", " ", "N"}], ",", 
           RowBox[{"m1", "=", "m"}], ",", 
           RowBox[{"m1", "=", "N"}]}], "]"}], ";"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"pointers", " ", "for", " ", "start", " ", "index"}], " ", 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"pntr", "=", 
        RowBox[{"Insert", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"Sum", "[", 
             RowBox[{
              RowBox[{"c", "[", 
               RowBox[{"N", ",", "j"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"j", ",", "0", ",", "i"}], "}"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "0", ",", "m1"}], "}"}]}], "]"}], ",", "0", 
          ",", "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"ntot", "=", 
        RowBox[{"pntr", "[", 
         RowBox[{"[", 
          RowBox[{"-", "1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Hg", "=", 
        RowBox[{"SparseArray", "[", 
         RowBox[{
          RowBox[{"{", "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"ntot", ",", "ntot"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"ind1", "=", 
           RowBox[{
            RowBox[{"pntr", "[", 
             RowBox[{"[", 
              RowBox[{"k", "+", "1"}], "]"}], "]"}], "+", 
            RowBox[{"Table", "[", 
             RowBox[{"i", ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "1", ",", 
                RowBox[{"c", "[", 
                 RowBox[{"N", ",", "k"}], "]"}]}], "}"}]}], "]"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"ind2", "=", 
           RowBox[{
            RowBox[{"pntr", "[", 
             RowBox[{"[", 
              RowBox[{"k", "+", "2"}], "]"}], "]"}], "+", 
            RowBox[{"HgMap", "[", 
             RowBox[{"N", ",", "k"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"Print", "[", 
             RowBox[{"HgMap", "[", 
              RowBox[{"N", ",", "k"}], "]"}], "]"}], ";"}], "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"coora", "=", 
           RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"Do", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"ind2sub", "=", 
              RowBox[{"ind2", "[", 
               RowBox[{"[", "j", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"Do", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"AppendTo", "[", 
                 RowBox[{"coora", ",", " ", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"ind1", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], ",", 
                    RowBox[{"ind2sub", "[", 
                    RowBox[{"[", "j2", "]"}], "]"}]}], "}"}]}], "]"}], ";"}], 
               "\[IndentingNewLine]", ",", 
               RowBox[{"{", 
                RowBox[{"j2", ",", "1", ",", 
                 RowBox[{"Length", "[", "ind2sub", "]"}]}], "}"}]}], "]"}], 
             ";"}], "\[IndentingNewLine]", ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", "1", ",", 
              RowBox[{"Length", "[", "ind1", "]"}]}], "}"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
            RowBox[{"caution", ":", " ", 
             RowBox[{
              RowBox[{"Sqrt", "[", 
               RowBox[{"m", "-", "k"}], "]"}], "*", "gg", " ", "contains", 
              " ", "m"}]}], ",", " ", 
            RowBox[{"not", " ", "m1"}]}], " ", "*)"}], "\[IndentingNewLine]", 
          
          RowBox[{"Hg", "+=", 
           RowBox[{"SparseArray", "[", 
            RowBox[{
             RowBox[{"coora", "\[Rule]", " ", 
              RowBox[{
               RowBox[{"Sqrt", "[", 
                RowBox[{"m", "-", "k"}], "]"}], "*", "gg"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"ntot", ",", "ntot"}], "}"}]}], "]"}]}], ";"}], 
         "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "0", ",", 
           RowBox[{"m1", "-", "1"}]}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Hg", "//", "Num"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}],
   "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"DiagH", "[", 
     RowBox[{"N_", ",", "m_", ",", "gg_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"Hg", ",", "eval", ",", "U", ",", "Uct"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"m", ">", "0"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Hg", "=", 
           RowBox[{"mkHg", "[", 
            RowBox[{"N", ",", "m", ",", "gg"}], "]"}]}], ";", 
          RowBox[{"Hg", "+=", 
           RowBox[{"Transpose", "[", "Hg", "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"Sort", ",", " ", 
            RowBox[{
             RowBox[{"ascending", " ", 
              RowBox[{
              "order", ":", "\[IndentingNewLine]", "ref", ":", " ", "https", 
               ":"}]}], "//", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"stackoverflow", ".", "com"}], "/", "questions"}], 
                "/", "6589005"}], "/", "sort"}], "-", "eigenvalue", "-", 
              "matrix", "-", "with", "-", "eigenvector", "-", "matrix"}]}]}], 
           " ", "*)"}], "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"eval", ",", "U"}], "}"}], "=", 
           RowBox[{"Transpose", "@", 
            RowBox[{"SortBy", "[", 
             RowBox[{
              RowBox[{"Transpose", "[", 
               RowBox[{"Eigensystem", "[", "Hg", "]"}], "]"}], ",", "First"}],
              "]"}]}]}], ";"}], "\[IndentingNewLine]", ",", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"make", " ", "E"}], "&"}], "U", " ", "by", " ", "hand"}], 
          " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"eval", "=", 
           RowBox[{"{", "0.0", "}"}]}], ";", 
          RowBox[{"U", "=", 
           RowBox[{"{", 
            RowBox[{"{", "1.0", "}"}], "}"}]}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"eval", ",", 
         RowBox[{"U", "//", "Transpose"}]}], "}"}]}]}], "\[IndentingNewLine]",
      "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"HgMapflip", "[", 
     RowBox[{"N_", ",", "k_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "tab", ",", "ind1", ",", "listi", ",", "tabx", ",", "sites", ",", 
        "flipsites", ",", "set1", ",", "flip", ",", "listf", ",", "xb", ",", 
        "xa", ",", "tabflip", ",", "tabflipx"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"tab", "=", 
        RowBox[{"{", "}"}]}], ";", 
       RowBox[{"tabx", "=", 
        RowBox[{"{", "}"}]}], ";", 
       RowBox[{"tabflip", "=", 
        RowBox[{"{", "}"}]}], ";", 
       RowBox[{"tabflipx", "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"listi", "=", 
        RowBox[{"comb", "[", 
         RowBox[{"N", ",", "k"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"sites", "=", 
        RowBox[{"Table", "[", 
         RowBox[{"i", ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "N"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"set1", "=", 
           RowBox[{"listi", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"flipsites", "=", 
           RowBox[{"Complement", "[", 
            RowBox[{"sites", ",", "set1"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Do", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"flip", "=", 
              RowBox[{"flipsites", "[", 
               RowBox[{"[", "j", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"listf", "=", 
              RowBox[{"Sort", "[", 
               RowBox[{"Join", "[", 
                RowBox[{"set1", ",", 
                 RowBox[{"{", "flip", "}"}]}], "]"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"xa", "=", 
              RowBox[{
               RowBox[{"c", "[", 
                RowBox[{"N", ",", 
                 RowBox[{"k", "+", "1"}]}], "]"}], "-", 
               RowBox[{"Sum", "[", 
                RowBox[{
                 RowBox[{"c", "[", 
                  RowBox[{
                   RowBox[{"N", "-", 
                    RowBox[{"listf", "[", 
                    RowBox[{"[", 
                    RowBox[{"p", "+", "1"}], "]"}], "]"}]}], ",", 
                   RowBox[{"k", "+", "1", "-", "p"}]}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"p", ",", "0", ",", "k"}], "}"}]}], "]"}]}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"AppendTo", "[", 
              RowBox[{"tabx", ",", "xa"}], "]"}], ";", "\[IndentingNewLine]", 
             
             RowBox[{"AppendTo", "[", 
              RowBox[{"tabflipx", ",", "flip"}], "]"}], ";"}], 
            "\[IndentingNewLine]", ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", "1", ",", 
              RowBox[{"Length", "[", "flipsites", "]"}]}], "}"}]}], "]"}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"tab", ",", "tabx"}], "]"}], ";", 
          RowBox[{"tabx", "=", 
           RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"tabflip", ",", "tabflipx"}], "]"}], ";", 
          RowBox[{"tabflipx", "=", 
           RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "listi", "]"}]}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"tab", ",", "tabflip"}], "}"}]}]}], "]"}]}], " ", ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"mkXb", "[", 
     RowBox[{"ii_", ",", "NN_", ",", "M_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"list", ",", "IM", ",", "xb"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"xb", "=", 
        RowBox[{"SparseArray", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{"i", ",", 
               RowBox[{"i", "+", "1"}]}], "}"}], "\[Rule]", " ", 
             RowBox[{"Sqrt", "[", "i", "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"M", "-", "1"}]}], "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"M", ",", "M"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"xb", " ", "+=", " ", 
        RowBox[{"Transpose", "[", "xb", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
          RowBox[{"xb", "//", "MatrixForm"}], "//", "Print"}], ";"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"list", "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"IM", "=", 
        RowBox[{"SparseArray", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Band", "[", 
             RowBox[{"{", 
              RowBox[{"1", ",", "1"}], "}"}], "]"}], "\[Rule]", "1"}], "}"}], 
          ",", 
          RowBox[{"{", 
           RowBox[{"M", ",", "M"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"j", "\[Equal]", "ii"}], ",", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"list", ",", "xb"}], "]"}], ",", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"list", ",", "IM"}], "]"}]}], "]"}], 
         "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", "NN"}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"KroneckerProduct", "@@", "list"}]}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"diagF", "=", 
    RowBox[{
     RowBox[{"SparseArray", "[", 
      RowBox[{
       RowBox[{"Band", "[", 
        RowBox[{"{", 
         RowBox[{"1", ",", "1"}], "}"}], "]"}], "\[Rule]", 
       RowBox[{"{", "##", "}"}]}], "]"}], "&"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  StyleBox[
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"makeHb", "[", 
      RowBox[{
       RowBox[{"N", "=", "sites"}], ",", 
       RowBox[{"M", "=", "vib_levels"}], ",", 
       RowBox[{"m", "=", 
        RowBox[{"exciton", "+", "photons"}]}]}], "]"}], ",", " ", 
     RowBox[{"out", " ", "=", " ", 
      RowBox[{
      "Hb", " ", "in", " ", "Full", " ", "Hilnert", " ", "space"}]}]}], " ", 
    "*)"}],
   FontSize->12]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"makeHb", "[", 
     RowBox[{"N_", ",", "M_", ",", "m_"}], "]"}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "pntr", ",", "ind1", ",", "ind2", ",", "coora", ",", "ntot", ",", "Hg",
         ",", "ind2sub", ",", "m1", ",", "tab", ",", "tabflip", ",", "flips", 
        ",", "i1", ",", "i2", ",", "iup", ",", "XB", ",", "Xb", ",", "Hb"}], 
       "}"}], ",", "\[IndentingNewLine]", 
      StyleBox[
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{
         "1.", " ", "make", " ", "displacement", " ", "operators", " ", 
          RowBox[{"Xb", "[", "i", "]"}]}], " ", "=", " ", 
         RowBox[{
          SubscriptBox["b", "i"], "+", 
          SuperscriptBox[
           SubscriptBox["b", "i"], "\[Dagger]"]}]}], "*)"}],
       FontSize->14], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Xb", "[", "i", "]"}], "=", 
          RowBox[{"mkXb", "[", 
           RowBox[{"i", ",", "N", ",", "M"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "N"}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       StyleBox[
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"2.", " ", "make", " ", 
           RowBox[{"XB", "'"}], "s", " ", "for", " ", "all", " ", "basis", 
           " ", "states", " ", "of", " ", "electron"}], "-", 
          RowBox[{"photon", " ", "subsystem"}]}], " ", "*)"}],
        FontSize->14], 
       StyleBox["\[IndentingNewLine]",
        FontSize->14], 
       RowBox[{"(*", 
        StyleBox[
         RowBox[{
          StyleBox[
           RowBox[{"(", "*"}]], " ", 
          RowBox[{
          "starting", " ", "state", " ", "needs", " ", "to", " ", "be", " ", 
           "defined", " ", "for", " ", "all", " ", "spin", " ", 
           RowBox[{"down", ":", " ", 
            RowBox[{"a", " ", "zero", " ", "matrix"}]}]}], " ", "*)"}],
         FontSize->14], "*)"}], 
       StyleBox["\[IndentingNewLine]",
        FontSize->14], 
       RowBox[{
        RowBox[{"XB", "[", "1", "]"}], "=", 
        RowBox[{"SparseArray", "[", 
         RowBox[{
          RowBox[{"{", "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"M", "^", "N"}], ",", 
            RowBox[{"M", "^", "N"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "seperate", " ", "case", " ", "with", " ", "saturated", " ", 
         "polarisation"}], " ", "*)"}], 
       StyleBox["\[IndentingNewLine]",
        FontSize->14], 
       RowBox[{"m1", "=", 
        RowBox[{"Min", "[", 
         RowBox[{"m", ",", "N"}], "]"}]}], ";", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"m", "\[LessEqual]", " ", "N"}], ",", 
           RowBox[{"m1", "=", "m"}], ",", 
           RowBox[{"m1", "=", "N"}]}], "]"}], ";"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"pointers", " ", "for", " ", "start", " ", "index"}], " ", 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"pntr", "=", 
        RowBox[{"Insert", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"Sum", "[", 
             RowBox[{
              RowBox[{"c", "[", 
               RowBox[{"N", ",", "j"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"j", ",", "0", ",", "i"}], "}"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "0", ",", "m1"}], "}"}]}], "]"}], ",", "0", 
          ",", "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"ntot", "=", 
        RowBox[{"pntr", "[", 
         RowBox[{"[", 
          RowBox[{"-", "1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"ind1", "=", 
           RowBox[{
            RowBox[{"pntr", "[", 
             RowBox[{"[", 
              RowBox[{"k", "+", "1"}], "]"}], "]"}], "+", 
            RowBox[{"Table", "[", 
             RowBox[{"i", ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "1", ",", 
                RowBox[{"c", "[", 
                 RowBox[{"N", ",", "k"}], "]"}]}], "}"}]}], "]"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"tab", ",", "tabflip"}], "}"}], "=", 
           RowBox[{"HgMapflip", "[", 
            RowBox[{"N", ",", "k"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"ind2", "=", 
           RowBox[{
            RowBox[{"pntr", "[", 
             RowBox[{"[", 
              RowBox[{"k", "+", "2"}], "]"}], "]"}], "+", "tab"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Do", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"ind2sub", "=", 
              RowBox[{"ind2", "[", 
               RowBox[{"[", "j", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"flips", "=", 
              RowBox[{"tabflip", "[", 
               RowBox[{"[", "j", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"Do", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"i1", ",", "i2", ",", "iup"}], "}"}], "=", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"ind1", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], ",", 
                   RowBox[{"ind2sub", "[", 
                    RowBox[{"[", "j2", "]"}], "]"}], ",", 
                   RowBox[{"flips", "[", 
                    RowBox[{"[", "j2", "]"}], "]"}]}], "}"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"(*", " ", 
                 RowBox[{"make", " ", "the", " ", "new", " ", 
                  RowBox[{"Sum", "[", 
                   RowBox[{
                    RowBox[{"Xb", "'"}], "s"}], "]"}], " ", "from", " ", 
                  "old", " ", "by", " ", "adding", " ", "the", " ", "flip", 
                  " ", 
                  RowBox[{"site", "'"}], "s", " ", "Xb"}], " ", "*)"}], 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"XB", "[", "i2", "]"}], "=", 
                 RowBox[{
                  RowBox[{"XB", "[", "i1", "]"}], " ", "+", " ", 
                  RowBox[{"Xb", "[", "iup", "]"}]}]}], ";"}], 
               "\[IndentingNewLine]", ",", 
               RowBox[{"{", 
                RowBox[{"j2", ",", "1", ",", 
                 RowBox[{"Length", "[", "ind2sub", "]"}]}], "}"}]}], "]"}], 
             ";"}], "\[IndentingNewLine]", ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", "1", ",", 
              RowBox[{"Length", "[", "ind1", "]"}]}], "}"}]}], "]"}], ";"}], 
         "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "0", ",", 
           RowBox[{"m1", "-", "1"}]}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       StyleBox[
        RowBox[{"(*", " ", 
         RowBox[{"3.", " ", "place", " ", "the", " ", 
          RowBox[{"XB", "'"}], "s", " ", "to", " ", "the", " ", "correct", 
          " ", "position", " ", "in", " ", "full", " ", "Hilbert", " ", 
          "space"}], " ", "*)"}],
        FontSize->14], "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"blocks", " ", "of", " ", "dim", " ", 
          RowBox[{"M", "^", "N"}], " ", "corresponding", " ", "to", " ", 
          "each", " ", "elec"}], "-", 
         RowBox[{
         "photon", " ", "basis", " ", "along", " ", "its", " ", 
          "diagonal"}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"Hb", "=", 
        RowBox[{"diagF", " ", "@@", " ", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"XB", "[", "i", "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "ntot"}], "}"}]}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Hb", "+=", 
        RowBox[{"Transpose", "[", "Hb", "]"}]}], ";", "\[IndentingNewLine]", 
       "Hb"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"makeHg", "[", 
     RowBox[{"N_", ",", "M_", ",", "m_", ",", "gg_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"Hg", ",", "Ivib", ",", "IM"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"vib", " ", "Identity"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"IM", "=", 
        RowBox[{"SparseArray", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Band", "[", 
             RowBox[{"{", 
              RowBox[{"1", ",", "1"}], "}"}], "]"}], "\[Rule]", "1"}], "}"}], 
          ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"M", "^", "N"}], ",", 
            RowBox[{"M", "^", "N"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"Hg", " ", "in", " ", "elec"}], "-", 
         RowBox[{"photon", " ", "subspace"}]}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"Hg", "=", 
        RowBox[{"mkHg", "[", 
         RowBox[{"N", ",", "m", ",", "gg"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Hg", "+=", 
        RowBox[{"Transpose", "[", "Hg", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"Hg", " ", "in", " ", "full", " ", "space"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"KroneckerProduct", "[", 
        RowBox[{"Hg", ",", "IM"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"makeHv", "[", 
     RowBox[{"NN_", ",", "M_", ",", "m_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "list", ",", "IM", ",", "bdb", ",", "Ielec", ",", "Hv", ",", "ntot"}], 
       "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"bdb", "=", 
        RowBox[{"SparseArray", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{"i", ",", "i"}], "}"}], "\[Rule]", " ", 
             RowBox[{"i", "-", "1"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", "M"}], "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"M", ",", "M"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"IM", "=", 
        RowBox[{"SparseArray", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Band", "[", 
             RowBox[{"{", 
              RowBox[{"1", ",", "1"}], "}"}], "]"}], "\[Rule]", "1"}], "}"}], 
          ",", 
          RowBox[{"{", 
           RowBox[{"M", ",", "M"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Hv", "=", 
        RowBox[{"SparseArray", "[", 
         RowBox[{
          RowBox[{"{", "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"M", "^", "NN"}], ",", 
            RowBox[{"M", "^", "NN"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"list", "=", 
           RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"Do", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"j", "\[Equal]", "ii"}], ",", 
              RowBox[{"AppendTo", "[", 
               RowBox[{"list", ",", "bdb"}], "]"}], ",", 
              RowBox[{"AppendTo", "[", 
               RowBox[{"list", ",", "IM"}], "]"}]}], "]"}], 
            "\[IndentingNewLine]", ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", "1", ",", "NN"}], "}"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Hv", " ", "+=", " ", 
           RowBox[{"KroneckerProduct", "@@", "list"}]}], ";"}], 
         "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"ii", ",", "1", ",", "NN"}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"ntot", "=", 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{"c", "[", 
           RowBox[{"NN", ",", "i"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "0", ",", 
            RowBox[{"Min", "[", 
             RowBox[{"m", ",", "NN"}], "]"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Ielec", "=", 
        RowBox[{"SparseArray", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Band", "[", 
             RowBox[{"{", 
              RowBox[{"1", ",", "1"}], "}"}], "]"}], "\[Rule]", "1"}], "}"}], 
          ",", 
          RowBox[{"{", 
           RowBox[{"ntot", ",", "ntot"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"KroneckerProduct", "[", 
        RowBox[{"Ielec", ",", "Hv"}], " ", "]"}]}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"map1dn", "[", 
     RowBox[{"N_", ",", "k_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"tabb", ",", "listi"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"listi", "=", 
        RowBox[{"comb", "[", 
         RowBox[{"N", ",", "k"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"tabb", "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"k", ">", "0"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Do", "[", 
           RowBox[{"(*", " ", 
            RowBox[{"1", "st", " ", "spin", " ", "is", " ", "dn"}], " ", 
            "*)"}], "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"FreeQ", "[", 
                RowBox[{
                 RowBox[{"listi", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], ",", "1"}], "]"}], ",", 
               RowBox[{
                RowBox[{"AppendTo", "[", 
                 RowBox[{"tabb", ",", "i"}], "]"}], ";"}]}], 
              "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Length", "[", "listi", "]"}]}], "}"}]}], "]"}], ";"}], 
         "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"tabb", "=", 
           RowBox[{"{", "1", "}"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], 
       ";", "\[IndentingNewLine]", "tabb"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"list", " ", "of", " ", "elec"}], "-", 
    RowBox[{
    "phot", " ", "states", " ", "with", " ", "site", " ", "1", " ", 
     "down"}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"mk1dnlist", "[", 
     RowBox[{"N_", ",", "m_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"m1", ",", "pntr", ",", "Htb", ",", "tab2", ",", "ind02"}], 
       "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"pointers", " ", "for", " ", "start", " ", "index"}], " ", 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"m1", "=", 
        RowBox[{"Min", "[", 
         RowBox[{"m", ",", "N"}], "]"}]}], ";", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"m2", "=", 
          RowBox[{"Min", "[", 
           RowBox[{
            RowBox[{"m", "-", "1"}], ",", "N"}], "]"}]}], ";", 
         RowBox[{"m3", "=", 
          RowBox[{"Min", "[", 
           RowBox[{
            RowBox[{"m", "+", "1"}], ",", "N"}], "]"}]}], ";"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"pntr", "=", 
        RowBox[{"Insert", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"Sum", "[", 
             RowBox[{
              RowBox[{"c", "[", 
               RowBox[{"N", ",", "j"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"j", ",", "0", ",", "i"}], "}"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "0", ",", "m1"}], "}"}]}], "]"}], ",", "0", 
          ",", "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Htb", "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "indices", " ", "list", " ", "of", " ", "initial", " ", "states"}], 
         " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"tab2", "=", 
           RowBox[{"map1dn", "[", 
            RowBox[{"N", ",", "k"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"ind02", "=", 
           RowBox[{
            RowBox[{"pntr", "[", 
             RowBox[{"[", 
              RowBox[{"k", "+", "1"}], "]"}], "]"}], "+", "tab2"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", "tab2", "]"}], ">", "0"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"AppendTo", "[", 
              RowBox[{"Htb", ",", "ind02"}], "]"}], ";"}]}], "]"}], ";"}], 
         "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "0", ",", "m1"}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Flatten", "[", 
        RowBox[{"Htb", ",", "1"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
   ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Probvib1dn", "[", 
    RowBox[{"psi_", ",", "NN_", ",", "m_", ",", "M_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "lst1dn", " ", ",", "nvib", ",", "nep", ",", "psii", ",", "nvib1", ",", 
       "prob", ",", "psi1", ",", "tot"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "restructure", " ", "psi", " ", "to", " ", "make", " ", "the", " ", 
       "blocks", " ", "of", " ", "vib", " ", "subspace"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"nvib", "=", 
       RowBox[{"M", "^", "NN"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"\"\<Length[psi]= \>\"", ",", 
          RowBox[{"Length", "[", "psi", "]"}]}], "]"}], ";"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"nep", "=", 
       RowBox[{
        RowBox[{"Length", "[", "psi", "]"}], "/", "nvib"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<nep, nvib = \>\"", ",", "nep", ",", " ", "\"\< \>\"", ",", 
          "nvib"}], "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"psi1", " ", "=", " ", 
       RowBox[{"ArrayReshape", "[", 
        RowBox[{"psi", ",", 
         RowBox[{"{", 
          RowBox[{"nep", ",", "nvib"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"psi1", "//", "Dimensions"}], "]"}], ";"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"list", " ", "of", " ", "elec"}], "-", 
        RowBox[{
        "phot", " ", "states", " ", "with", " ", "site", " ", "1", " ", 
         "down"}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"lst1dn", " ", "=", " ", 
       RowBox[{"mk1dnlist", "[", 
        RowBox[{"NN", ",", "m"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "pick", " ", "these", " ", "sectors", " ", "and", " ", "reduce", " ", 
        "vib", " ", "state"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"nvib1", "=", 
       RowBox[{"nvib", "/", "M"}]}], ";", 
      RowBox[{"(*", " ", 
       RowBox[{"=", " ", 
        RowBox[{
         RowBox[{"M", "^", 
          RowBox[{"(", 
           RowBox[{"NN", "-", "1"}], ")"}]}], " ", "states", " ", "for", " ", 
         "each", " ", "vib", " ", "level", " ", "of", " ", "site", " ", 
         "1"}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"prob", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "M"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"psii", "=", 
          RowBox[{"ArrayReshape", "[", 
           RowBox[{
            RowBox[{"psi1", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"M", ",", "nvib1"}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"prob", " ", "+=", 
          RowBox[{"Total", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Abs", "[", "psii", "]"}], "^", "2"}], ",", 
            RowBox[{"{", "2", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
        ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "lst1dn"}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"tot", "=", 
       RowBox[{"Total", "[", "prob", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"tot", "\[NotEqual]", " ", "0"}], ",", 
        RowBox[{"prob", "=", 
         RowBox[{"prob", "/", "tot"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
      "prob"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.708884148310175*^9, 3.708884168379202*^9}, 
   3.7088881317075*^9, 3.708891406771698*^9, {3.7088934342768*^9, 
   3.7088934555439568`*^9}, {3.708893627744693*^9, 3.708893653015018*^9}, {
   3.7088955239444532`*^9, 3.708895525116046*^9}, {3.7089285061181183`*^9, 
   3.708928506598136*^9}, {3.708928611051597*^9, 3.7089288447563543`*^9}, {
   3.708928877802004*^9, 3.70892898410039*^9}, {3.708929044950604*^9, 
   3.708929084569128*^9}, {3.7089291600979958`*^9, 3.7089291618967*^9}, {
   3.7089292048299026`*^9, 3.7089294214709797`*^9}, {3.70892950340226*^9, 
   3.708929567199287*^9}, {3.7089296260840607`*^9, 3.708929781816904*^9}, {
   3.708929828657712*^9, 3.708930043990054*^9}, {3.708930162050187*^9, 
   3.708930287405827*^9}, {3.708930426648575*^9, 3.7089304341937933`*^9}, {
   3.708930479812463*^9, 3.708930488011242*^9}, {3.7089305466991177`*^9, 
   3.708930548414874*^9}, {3.708930580194695*^9, 3.708930593313322*^9}, {
   3.708930646185912*^9, 3.708930655144732*^9}, {3.708930745958737*^9, 
   3.708930785818102*^9}, {3.70893226989264*^9, 3.7089322750890903`*^9}, 
   3.708932333753538*^9, {3.70893237557204*^9, 3.708932390197256*^9}, {
   3.708934973359762*^9, 3.70893503751867*^9}, {3.708935582036763*^9, 
   3.7089355832152243`*^9}, {3.7089356517465076`*^9, 3.7089357595781116`*^9}, 
   3.709290194247324*^9}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"wv", "=", "0.2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gg", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"lam", "=", "2"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NN", "=", "5"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"M", "=", "5"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"mmax", "=", "7"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"prob", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ntot", "=", 
      RowBox[{
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{"c", "[", 
          RowBox[{"NN", ",", "i"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "0", ",", 
           RowBox[{"Min", "[", 
            RowBox[{"m", ",", "NN"}], "]"}]}], "}"}]}], "]"}], " ", "*", " ", 
       
       RowBox[{"M", "^", "NN"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"wvlam", "=", 
      RowBox[{"wv", "*", "lam"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"H", " ", "=", " ", 
      RowBox[{
       RowBox[{"wv", "*", 
        RowBox[{"makeHv", "[", 
         RowBox[{"NN", ",", "M", ",", "m"}], "]"}]}], " ", "+", " ", 
       RowBox[{"makeHg", "[", 
        RowBox[{"NN", ",", "M", ",", "m", ",", "gg"}], "]"}], " ", "+", " ", 
       RowBox[{"wvlam", "*", 
        RowBox[{"makeHb", "[", 
         RowBox[{"NN", ",", "M", ",", "m"}], "]"}]}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"nn", "=", 
      RowBox[{"Norm", "[", 
       RowBox[{"Flatten", "[", "H", "]"}], "]"}]}], ";", "\n", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"eval", ",", "evec"}], "}"}], "=", 
      RowBox[{"Eigensystem", "[", 
       RowBox[{
        RowBox[{"H", "-", 
         RowBox[{"nn", "*", 
          RowBox[{"SparseArray", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Band", "[", 
               RowBox[{"{", 
                RowBox[{"1", ",", "1"}], "}"}], "]"}], "\[Rule]", "1"}], 
             "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"ntot", ",", "ntot"}], "}"}]}], "]"}]}]}], ",", "1"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"eval", "=", 
      RowBox[{"eval", "+", "nn"}]}], ";", 
     RowBox[{"eval", "//", "Print"}], ";", "\[IndentingNewLine]", 
     RowBox[{"pr", "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"Probvib1dn", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"evec", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "//", "Chop"}], ",", "NN", ",", 
          "m", ",", "M"}], "]"}], "}"}], "//", "Transpose"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"pr2", "=", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"Table", "[", 
           RowBox[{"i", ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "0", ",", 
              RowBox[{"M", "-", "1"}]}], "}"}]}], "]"}], "}"}], "//", 
         "Transpose"}], ",", "pr", ",", "2"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"AppendTo", "[", 
      RowBox[{"prob", ",", "pr2"}], "]"}], ";"}], "\[IndentingNewLine]", ",", 
    
    RowBox[{"{", 
     RowBox[{"m", ",", "0", ",", "mmax"}], "}"}]}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{
  3.7088933023200817`*^9, {3.708893333584344*^9, 3.708893412740923*^9}, {
   3.708893476345666*^9, 3.7088935845289917`*^9}, 3.7088943536635942`*^9, {
   3.708894642008135*^9, 3.708894650647451*^9}, {3.708894701751013*^9, 
   3.708894755684969*^9}, {3.708894908314303*^9, 3.708894924232497*^9}, {
   3.708895157720447*^9, 3.7088952664388437`*^9}, 3.708895341625511*^9, {
   3.7088954285983973`*^9, 3.708895428691862*^9}, {3.708930987966345*^9, 
   3.7089311306315413`*^9}, {3.70893133777532*^9, 3.708931417541704*^9}, 
   3.7089315002706213`*^9, {3.708931755610939*^9, 3.7089318417475243`*^9}, {
   3.708931877845356*^9, 3.708931918698118*^9}, 3.7089319944331017`*^9, 
   3.708932030632489*^9, {3.7089324834293747`*^9, 3.708932483580134*^9}, {
   3.708932523212344*^9, 3.7089325401201353`*^9}, {3.708932595748063*^9, 
   3.7089327900789757`*^9}, 3.708934462438499*^9, {3.708935131758389*^9, 
   3.7089351318191643`*^9}, {3.708935871190325*^9, 3.708935879060194*^9}, {
   3.7089775006983843`*^9, 3.708977509801405*^9}, {3.708977581385583*^9, 
   3.7089775867933693`*^9}, {3.708977651571374*^9, 3.708977651713573*^9}, {
   3.70897770111122*^9, 3.70897770217198*^9}, {3.708977877964332*^9, 
   3.7089778920035563`*^9}, {3.708978033549008*^9, 3.708978036384388*^9}, {
   3.708978087859366*^9, 3.7089781127047663`*^9}, {3.7092901584608307`*^9, 
   3.709290165245481*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"-", "2.842170943040401`*^-14"}], "}"}]], "Print",
 CellChangeTimes->{
  3.708934466635618*^9, 3.708935093560933*^9, 3.708935132802252*^9, {
   3.708935854156958*^9, 3.708935880184559*^9}, 3.708977516826366*^9, 
   3.708977590022682*^9, 3.708977655682777*^9, 3.708977708142194*^9, 
   3.7089778936991158`*^9, 3.708978040575164*^9, 3.7089781155281754`*^9, 
   3.709290202086337*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"-", "2.6296083735052207`"}], "}"}]], "Print",
 CellChangeTimes->{
  3.708934466635618*^9, 3.708935093560933*^9, 3.708935132802252*^9, {
   3.708935854156958*^9, 3.708935880184559*^9}, 3.708977516826366*^9, 
   3.708977590022682*^9, 3.708977655682777*^9, 3.708977708142194*^9, 
   3.7089778936991158`*^9, 3.708978040575164*^9, 3.7089781155281754`*^9, 
   3.7092902024254093`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"-", "5.307378346505175`"}], "}"}]], "Print",
 CellChangeTimes->{
  3.708934466635618*^9, 3.708935093560933*^9, 3.708935132802252*^9, {
   3.708935854156958*^9, 3.708935880184559*^9}, 3.708977516826366*^9, 
   3.708977590022682*^9, 3.708977655682777*^9, 3.708977708142194*^9, 
   3.7089778936991158`*^9, 3.708978040575164*^9, 3.7089781155281754`*^9, 
   3.709290204150852*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"-", "7.909642329267626`"}], "}"}]], "Print",
 CellChangeTimes->{
  3.708934466635618*^9, 3.708935093560933*^9, 3.708935132802252*^9, {
   3.708935854156958*^9, 3.708935880184559*^9}, 3.708977516826366*^9, 
   3.708977590022682*^9, 3.708977655682777*^9, 3.708977708142194*^9, 
   3.7089778936991158`*^9, 3.708978040575164*^9, 3.7089781155281754`*^9, 
   3.709290208415804*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"-", "10.286943084127643`"}], "}"}]], "Print",
 CellChangeTimes->{
  3.708934466635618*^9, 3.708935093560933*^9, 3.708935132802252*^9, {
   3.708935854156958*^9, 3.708935880184559*^9}, 3.708977516826366*^9, 
   3.708977590022682*^9, 3.708977655682777*^9, 3.708977708142194*^9, 
   3.7089778936991158`*^9, 3.708978040575164*^9, 3.7089781155281754`*^9, 
   3.709290214171339*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"-", "12.266366115090932`"}], "}"}]], "Print",
 CellChangeTimes->{
  3.708934466635618*^9, 3.708935093560933*^9, 3.708935132802252*^9, {
   3.708935854156958*^9, 3.708935880184559*^9}, 3.708977516826366*^9, 
   3.708977590022682*^9, 3.708977655682777*^9, 3.708977708142194*^9, 
   3.7089778936991158`*^9, 3.708978040575164*^9, 3.7089781155281754`*^9, 
   3.709290219857795*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"-", "13.731557784895358`"}], "}"}]], "Print",
 CellChangeTimes->{
  3.708934466635618*^9, 3.708935093560933*^9, 3.708935132802252*^9, {
   3.708935854156958*^9, 3.708935880184559*^9}, 3.708977516826366*^9, 
   3.708977590022682*^9, 3.708977655682777*^9, 3.708977708142194*^9, 
   3.7089778936991158`*^9, 3.708978040575164*^9, 3.7089781155281754`*^9, 
   3.709290225914583*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"-", "14.966373039794917`"}], "}"}]], "Print",
 CellChangeTimes->{
  3.708934466635618*^9, 3.708935093560933*^9, 3.708935132802252*^9, {
   3.708935854156958*^9, 3.708935880184559*^9}, 3.708977516826366*^9, 
   3.708977590022682*^9, 3.708977655682777*^9, 3.708977708142194*^9, 
   3.7089778936991158`*^9, 3.708978040575164*^9, 3.7089781155281754`*^9, 
   3.7092902333222523`*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"labels", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"\"\<m = \>\"", "<>", 
        RowBox[{"ToString", "[", "i", "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "0", ",", "mmax"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"ListPlot", "[", 
    RowBox[{"prob", ",", 
     RowBox[{"Joined", "\[Rule]", "True"}], ",", 
     RowBox[{"PlotMarkers", "\[Rule]", 
      RowBox[{"{", "\"\<\[FilledCircle]\>\"", "}"}]}], ",", 
     RowBox[{"PlotLegends", "\[Rule]", 
      RowBox[{"Placed", "[", 
       RowBox[{"labels", ",", "Right"}], "]"}]}], ",", "\[IndentingNewLine]", 
     
     RowBox[{"LabelStyle", "\[Rule]", 
      RowBox[{"Directive", "[", "\"\<Large\>\"", "]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"PlotLabel", "\[Rule]", 
      RowBox[{
      "Style", "[", "\"\<Vibrational occupations for a down spin\>\"", 
       "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"Epilog", "\[Rule]", 
      RowBox[{"Inset", "[", 
       RowBox[{
        RowBox[{"Text", "[", 
         RowBox[{"Style", "[", 
          RowBox[{
           RowBox[{"\"\<N=\>\"", "<>", 
            RowBox[{"ToString", "[", "NN", "]"}], "<>", 
            "\"\<, \!\(\*SubscriptBox[\(\[Omega]\), \(v\)]\)=0.2, \
\!\(\*SubscriptBox[\(\[Omega]\), \(R\)]\)=1, \
\!\(\*SubscriptBox[\(\[Lambda]\), \(0\)]\)=\>\"", "<>", 
            RowBox[{"ToString", "[", "lam", "]"}]}], ",", 
           RowBox[{"FontSize", "\[Rule]", " ", "25"}]}], "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"2", ",", "0.7"}], "}"}]}], "]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"FrameLabel", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "\"\<\!\(\*SubscriptBox[\(P\), SubscriptBox[\(n\), \(v\)]]\)\>\"", 
          ",", "None"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"\"\<\!\(\*SubscriptBox[\(n\), \(v\)]\)\>\"", ",", "None"}], 
         "}"}]}], "}"}]}], ",", 
     RowBox[{"FrameTicks", "\[Rule]", "All"}], ",", "\[IndentingNewLine]", 
     RowBox[{"ImageSize", "\[Rule]", "500"}], ",", 
     RowBox[{"Axes", "\[Rule]", "False"}], ",", 
     RowBox[{"Frame", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"True", ",", "False"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}]}], 
    "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.708932831532507*^9, 3.7089329603613033`*^9}, {
  3.708933014606853*^9, 3.708933040579773*^9}, {3.708933105943077*^9, 
  3.708933181397217*^9}, {3.708933310560411*^9, 3.708933315885951*^9}, {
  3.708933522152123*^9, 3.708933760351615*^9}, {3.708933802167748*^9, 
  3.708933834917543*^9}, {3.708933939760591*^9, 3.708934058755355*^9}, {
  3.708934103693635*^9, 3.708934135941163*^9}, {3.708934189076331*^9, 
  3.7089341969315434`*^9}, {3.7089342317613688`*^9, 3.7089343375206013`*^9}, {
  3.708935312193972*^9, 3.708935317314143*^9}, {3.709290324715847*^9, 
  3.709290340274246*^9}, {3.7092903877794647`*^9, 3.709290618516643*^9}, {
  3.709290652199114*^9, 3.70929075785948*^9}, {3.7092908250012627`*^9, 
  3.709290950628366*^9}, {3.709291037566251*^9, 3.709291152145198*^9}, {
  3.709291266725882*^9, 3.709291444665348*^9}, {3.709291496073723*^9, 
  3.709291511853444*^9}}],

Cell[BoxData[
 TemplateBox[{GraphicsBox[{{}, {{{}, {}, {
        Hue[0.67, 0.6, 0.6], 
        Directive[
         PointSize[0.012833333333333334`], 
         RGBColor[0.368417, 0.506779, 0.709798], 
         AbsoluteThickness[1.6]], 
        LineBox[{{0., 0.9999999999999994}, {1., 2.0010915429409183`*^-16}, {
         2., 1.6170391625397525`*^-16}, {3., 1.2294921543884648`*^-16}, {4., 
         1.301847448088*^-16}}]}, {
        Hue[0.9060679774997897, 0.6, 0.6], 
        Directive[
         PointSize[0.012833333333333334`], 
         RGBColor[0.880722, 0.611041, 0.142051], 
         AbsoluteThickness[1.6]], 
        LineBox[{{0., 0.8692491878027925}, {1., 0.09405774451714301}, {2., 
         0.02671996615763742}, {3., 0.008387906763167153}, {4., 
         0.0015851947592599445`}}]}, {
        Hue[0.1421359549995791, 0.6, 0.6], 
        Directive[
         PointSize[0.012833333333333334`], 
         RGBColor[0.560181, 0.691569, 0.194885], 
         AbsoluteThickness[1.6]], 
        LineBox[{{0., 0.603178940132544}, {1., 0.24368486711459356`}, {2., 
         0.1064403335778742}, {3., 0.038932358186058544`}, {4., 
         0.0077635009889294735`}}]}, {
        Hue[0.37820393249936934`, 0.6, 0.6], 
        Directive[
         PointSize[0.012833333333333334`], 
         RGBColor[0.922526, 0.385626, 0.209179], 
         AbsoluteThickness[1.6]], 
        LineBox[{{0., 0.33242388959649266`}, {1., 0.3268921283174261}, {2., 
         0.21887977344639575`}, {3., 0.09959038365853966}, {4., 
         0.022213824981145686`}}]}, {
        Hue[0.6142719099991583, 0.6, 0.6], 
        Directive[
         PointSize[0.012833333333333334`], 
         RGBColor[0.528488, 0.470624, 0.701351], 
         AbsoluteThickness[1.6]], 
        LineBox[{{0., 0.16508492349897164`}, {1., 0.3111776844722158}, {2., 
         0.3048074354344485}, {3., 0.174394396393632}, {4., 
         0.04453556020073212}}]}, {
        Hue[0.8503398874989481, 0.6, 0.6], 
        Directive[
         PointSize[0.012833333333333334`], 
         RGBColor[0.772079, 0.431554, 0.102387], 
         AbsoluteThickness[1.6]], 
        LineBox[{{0., 0.0974541922928483}, {1., 0.2678635571990359}, {2., 
         0.3385713976903989}, {3., 0.23024190708672532`}, {4., 
         0.06586894573099157}}]}, {
        Hue[0.08640786499873876, 0.6, 0.6], 
        Directive[
         PointSize[0.012833333333333334`], 
         RGBColor[0.363898, 0.618501, 0.782349], 
         AbsoluteThickness[1.6]], 
        LineBox[{{0., 0.0882206503084992}, {1., 0.2584661824512507}, {2., 
         0.342024700695758}, {3., 0.24061611587331913`}, {4., 
         0.07067235067117285}}]}, {
        Hue[0.3224758424985268, 0.6, 0.6], 
        Directive[
         PointSize[0.012833333333333334`], 
         RGBColor[1, 0.75, 0], 
         AbsoluteThickness[1.6]], 
        LineBox[{{0., 0.08484897329109226}, {1., 0.25473156437261696`}, {2., 
         0.34307927868297533`}, {3., 0.24464568450202723`}, {4., 
         0.07269449915128819}}]}}, {{
        Directive[
         PointSize[0.012833333333333334`], 
         RGBColor[0.368417, 0.506779, 0.709798], 
         AbsoluteThickness[1.6], 
         AbsolutePointSize[6]], 
        GeometricTransformationBox[
         TagBox[
          InsetBox["\[FilledCircle]", {0., 0.}], "InsetString"], {{{0., 
         0.9999999999999994}}, {{1., 2.0010915429409183`*^-16}}, {{2., 
         1.6170391625397525`*^-16}}, {{3., 1.2294921543884648`*^-16}}, {{4., 
         1.301847448088*^-16}}}]}, {
        Directive[
         PointSize[0.012833333333333334`], 
         RGBColor[0.880722, 0.611041, 0.142051], 
         AbsoluteThickness[1.6], 
         AbsolutePointSize[6]], 
        GeometricTransformationBox[
         TagBox[
          InsetBox["\[FilledCircle]", {0., 0.}], "InsetString"], {{{0., 
         0.8692491878027925}}, {{1., 0.09405774451714301}}, {{2., 
         0.02671996615763742}}, {{3., 0.008387906763167153}}, {{4., 
         0.0015851947592599445`}}}]}, {
        Directive[
         PointSize[0.012833333333333334`], 
         RGBColor[0.560181, 0.691569, 0.194885], 
         AbsoluteThickness[1.6], 
         AbsolutePointSize[6]], 
        GeometricTransformationBox[
         TagBox[
          InsetBox["\[FilledCircle]", {0., 0.}], "InsetString"], {{{0., 
         0.603178940132544}}, {{1., 0.24368486711459356`}}, {{2., 
         0.1064403335778742}}, {{3., 0.038932358186058544`}}, {{4., 
         0.0077635009889294735`}}}]}, {
        Directive[
         PointSize[0.012833333333333334`], 
         RGBColor[0.922526, 0.385626, 0.209179], 
         AbsoluteThickness[1.6], 
         AbsolutePointSize[6]], 
        GeometricTransformationBox[
         TagBox[
          InsetBox["\[FilledCircle]", {0., 0.}], "InsetString"], {{{0., 
         0.33242388959649266`}}, {{1., 0.3268921283174261}}, {{2., 
         0.21887977344639575`}}, {{3., 0.09959038365853966}}, {{4., 
         0.022213824981145686`}}}]}, {
        Directive[
         PointSize[0.012833333333333334`], 
         RGBColor[0.528488, 0.470624, 0.701351], 
         AbsoluteThickness[1.6], 
         AbsolutePointSize[6]], 
        GeometricTransformationBox[
         TagBox[
          InsetBox["\[FilledCircle]", {0., 0.}], "InsetString"], {{{0., 
         0.16508492349897164`}}, {{1., 0.3111776844722158}}, {{2., 
         0.3048074354344485}}, {{3., 0.174394396393632}}, {{4., 
         0.04453556020073212}}}]}, {
        Directive[
         PointSize[0.012833333333333334`], 
         RGBColor[0.772079, 0.431554, 0.102387], 
         AbsoluteThickness[1.6], 
         AbsolutePointSize[6]], 
        GeometricTransformationBox[
         TagBox[
          InsetBox["\[FilledCircle]", {0., 0.}], "InsetString"], {{{0., 
         0.0974541922928483}}, {{1., 0.2678635571990359}}, {{2., 
         0.3385713976903989}}, {{3., 0.23024190708672532`}}, {{4., 
         0.06586894573099157}}}]}, {
        Directive[
         PointSize[0.012833333333333334`], 
         RGBColor[0.363898, 0.618501, 0.782349], 
         AbsoluteThickness[1.6], 
         AbsolutePointSize[6]], 
        GeometricTransformationBox[
         TagBox[
          InsetBox["\[FilledCircle]", {0., 0.}], "InsetString"], {{{0., 
         0.0882206503084992}}, {{1., 0.2584661824512507}}, {{2., 
         0.342024700695758}}, {{3., 0.24061611587331913`}}, {{4., 
         0.07067235067117285}}}]}, {
        Directive[
         PointSize[0.012833333333333334`], 
         RGBColor[1, 0.75, 0], 
         AbsoluteThickness[1.6], 
         AbsolutePointSize[6]], 
        GeometricTransformationBox[
         TagBox[
          InsetBox["\[FilledCircle]", {0., 0.}], "InsetString"], {{{0., 
         0.08484897329109226}}, {{1., 0.25473156437261696`}}, {{2., 
         0.34307927868297533`}}, {{3., 0.24464568450202723`}}, {{4., 
         0.07269449915128819}}}]}, {}}}, {}}, {
    DisplayFunction -> Identity, PlotRangePadding -> {{
        Scaled[0.02], 
        Scaled[0.02]}, {
        Scaled[0.02], 
        Scaled[0.05]}}, AxesOrigin -> {0, 0}, 
     PlotRange -> {{0, 4.}, {0, 0.9999999999999994}}, PlotRangeClipping -> 
     True, ImagePadding -> All, DisplayFunction -> Identity, AspectRatio -> 
     NCache[GoldenRatio^(-1), 0.6180339887498948], Axes -> {False, False}, 
     AxesLabel -> {None, None}, AxesOrigin -> {0, 0}, DisplayFunction :> 
     Identity, Epilog -> InsetBox[
       BoxData[
        FormBox[
         InterpretationBox[
          Cell[
           BoxData[
            FormBox[
             StyleBox[
             "\"N=5, \\!\\(\\*SubscriptBox[\\(\[Omega]\\), \\(v\\)]\\)=0.2, \
\\!\\(\\*SubscriptBox[\\(\[Omega]\\), \\(R\\)]\\)=1, \
\\!\\(\\*SubscriptBox[\\(\[Lambda]\\), \\(0\\)]\\)=2\"", FontSize -> 25, 
              StripOnInput -> False], TextForm]], "InlineText"], 
          Text[
           Style[
           "N=5, \!\(\*SubscriptBox[\(\[Omega]\), \(v\)]\)=0.2, \
\!\(\*SubscriptBox[\(\[Omega]\), \(R\)]\)=1, \
\!\(\*SubscriptBox[\(\[Lambda]\), \(0\)]\)=2", FontSize -> 25]]], 
         TraditionalForm]], {2, 0.7}], 
     Frame -> {{True, False}, {True, False}}, FrameLabel -> {{
        FormBox[
        "\"\\!\\(\\*SubscriptBox[\\(P\\), SubscriptBox[\\(n\\), \
\\(v\\)]]\\)\"", TraditionalForm], None}, {
        FormBox[
        "\"\\!\\(\\*SubscriptBox[\\(n\\), \\(v\\)]\\)\"", TraditionalForm], 
        None}}, FrameTicks -> {{All, All}, {All, All}}, 
     GridLines -> {None, None}, GridLinesStyle -> Directive[
       GrayLevel[0.5, 0.4]], ImageSize -> 500, LabelStyle -> 
     Directive["Large"], 
     Method -> {"CoordinatesToolOptions" -> {"DisplayFunction" -> ({
           (Part[{{Identity, Identity}, {Identity, Identity}}, 1, 2][#]& )[
            Part[#, 1]], 
           (Part[{{Identity, Identity}, {Identity, Identity}}, 2, 2][#]& )[
            Part[#, 2]]}& ), "CopiedValueFunction" -> ({
           (Part[{{Identity, Identity}, {Identity, Identity}}, 1, 2][#]& )[
            Part[#, 1]], 
           (Part[{{Identity, Identity}, {Identity, Identity}}, 2, 2][#]& )[
            Part[#, 2]]}& )}}, PlotLabel -> FormBox[
       StyleBox[
       "\"Vibrational occupations for a down spin\"", StripOnInput -> False], 
       TraditionalForm], PlotRange -> {{0, 4.}, {0, 0.9999999999999994}}, 
     PlotRangeClipping -> True, PlotRangePadding -> {{
        Scaled[0.02], 
        Scaled[0.02]}, {
        Scaled[0.02], 
        Scaled[0.05]}}, Ticks -> {Automatic, Automatic}}],FormBox[
    FormBox[
     TemplateBox[{
      "\"m = 0\"", "\"m = 1\"", "\"m = 2\"", "\"m = 3\"", "\"m = 4\"", 
       "\"m = 5\"", "\"m = 6\"", "\"m = 7\""}, "PointLegend", 
      DisplayFunction -> (FormBox[
        StyleBox[
         StyleBox[
          PaneBox[
           TagBox[
            GridBox[{{
               TagBox[
                GridBox[{{
                   GraphicsBox[{{
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.231], 
                    RGBColor[0.368417, 0.506779, 0.709798], 
                    AbsoluteThickness[1.6]], {
                    LineBox[{{0, 10}, {20, 10}}]}}, {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.231], 
                    RGBColor[0.368417, 0.506779, 0.709798], 
                    AbsoluteThickness[1.6]], {
                    InsetBox[
                    FormBox[
                    StyleBox["\"\[FilledCircle]\"", 
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.231], 
                    RGBColor[0.368417, 0.506779, 0.709798], 
                    AbsoluteThickness[1.6]], FontSize -> 10, Plain, 
                    StripOnInput -> False], TraditionalForm], 
                    NCache[
                    Scaled[{
                    Rational[1, 2], 
                    Rational[1, 2]}], 
                    Scaled[{0.5, 0.5}]]]}}}, AspectRatio -> Full, 
                    ImageSize -> {20, 10}, PlotRangePadding -> None, 
                    ImagePadding -> Automatic, 
                    BaselinePosition -> (Scaled[0.1] -> Baseline)], #}, {
                   GraphicsBox[{{
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.231], 
                    RGBColor[0.880722, 0.611041, 0.142051], 
                    AbsoluteThickness[1.6]], {
                    LineBox[{{0, 10}, {20, 10}}]}}, {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.231], 
                    RGBColor[0.880722, 0.611041, 0.142051], 
                    AbsoluteThickness[1.6]], {
                    InsetBox[
                    FormBox[
                    StyleBox["\"\[FilledCircle]\"", 
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.231], 
                    RGBColor[0.880722, 0.611041, 0.142051], 
                    AbsoluteThickness[1.6]], FontSize -> 10, Plain, 
                    StripOnInput -> False], TraditionalForm], 
                    NCache[
                    Scaled[{
                    Rational[1, 2], 
                    Rational[1, 2]}], 
                    Scaled[{0.5, 0.5}]]]}}}, AspectRatio -> Full, 
                    ImageSize -> {20, 10}, PlotRangePadding -> None, 
                    ImagePadding -> Automatic, 
                    BaselinePosition -> (Scaled[0.1] -> Baseline)], #2}, {
                   GraphicsBox[{{
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.231], 
                    RGBColor[0.560181, 0.691569, 0.194885], 
                    AbsoluteThickness[1.6]], {
                    LineBox[{{0, 10}, {20, 10}}]}}, {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.231], 
                    RGBColor[0.560181, 0.691569, 0.194885], 
                    AbsoluteThickness[1.6]], {
                    InsetBox[
                    FormBox[
                    StyleBox["\"\[FilledCircle]\"", 
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.231], 
                    RGBColor[0.560181, 0.691569, 0.194885], 
                    AbsoluteThickness[1.6]], FontSize -> 10, Plain, 
                    StripOnInput -> False], TraditionalForm], 
                    NCache[
                    Scaled[{
                    Rational[1, 2], 
                    Rational[1, 2]}], 
                    Scaled[{0.5, 0.5}]]]}}}, AspectRatio -> Full, 
                    ImageSize -> {20, 10}, PlotRangePadding -> None, 
                    ImagePadding -> Automatic, 
                    BaselinePosition -> (Scaled[0.1] -> Baseline)], #3}, {
                   GraphicsBox[{{
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.231], 
                    RGBColor[0.922526, 0.385626, 0.209179], 
                    AbsoluteThickness[1.6]], {
                    LineBox[{{0, 10}, {20, 10}}]}}, {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.231], 
                    RGBColor[0.922526, 0.385626, 0.209179], 
                    AbsoluteThickness[1.6]], {
                    InsetBox[
                    FormBox[
                    StyleBox["\"\[FilledCircle]\"", 
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.231], 
                    RGBColor[0.922526, 0.385626, 0.209179], 
                    AbsoluteThickness[1.6]], FontSize -> 10, Plain, 
                    StripOnInput -> False], TraditionalForm], 
                    NCache[
                    Scaled[{
                    Rational[1, 2], 
                    Rational[1, 2]}], 
                    Scaled[{0.5, 0.5}]]]}}}, AspectRatio -> Full, 
                    ImageSize -> {20, 10}, PlotRangePadding -> None, 
                    ImagePadding -> Automatic, 
                    BaselinePosition -> (Scaled[0.1] -> Baseline)], #4}, {
                   GraphicsBox[{{
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.231], 
                    RGBColor[0.528488, 0.470624, 0.701351], 
                    AbsoluteThickness[1.6]], {
                    LineBox[{{0, 10}, {20, 10}}]}}, {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.231], 
                    RGBColor[0.528488, 0.470624, 0.701351], 
                    AbsoluteThickness[1.6]], {
                    InsetBox[
                    FormBox[
                    StyleBox["\"\[FilledCircle]\"", 
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.231], 
                    RGBColor[0.528488, 0.470624, 0.701351], 
                    AbsoluteThickness[1.6]], FontSize -> 10, Plain, 
                    StripOnInput -> False], TraditionalForm], 
                    NCache[
                    Scaled[{
                    Rational[1, 2], 
                    Rational[1, 2]}], 
                    Scaled[{0.5, 0.5}]]]}}}, AspectRatio -> Full, 
                    ImageSize -> {20, 10}, PlotRangePadding -> None, 
                    ImagePadding -> Automatic, 
                    BaselinePosition -> (Scaled[0.1] -> Baseline)], #5}, {
                   GraphicsBox[{{
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.231], 
                    RGBColor[0.772079, 0.431554, 0.102387], 
                    AbsoluteThickness[1.6]], {
                    LineBox[{{0, 10}, {20, 10}}]}}, {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.231], 
                    RGBColor[0.772079, 0.431554, 0.102387], 
                    AbsoluteThickness[1.6]], {
                    InsetBox[
                    FormBox[
                    StyleBox["\"\[FilledCircle]\"", 
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.231], 
                    RGBColor[0.772079, 0.431554, 0.102387], 
                    AbsoluteThickness[1.6]], FontSize -> 10, Plain, 
                    StripOnInput -> False], TraditionalForm], 
                    NCache[
                    Scaled[{
                    Rational[1, 2], 
                    Rational[1, 2]}], 
                    Scaled[{0.5, 0.5}]]]}}}, AspectRatio -> Full, 
                    ImageSize -> {20, 10}, PlotRangePadding -> None, 
                    ImagePadding -> Automatic, 
                    BaselinePosition -> (Scaled[0.1] -> Baseline)], #6}, {
                   GraphicsBox[{{
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.231], 
                    RGBColor[0.363898, 0.618501, 0.782349], 
                    AbsoluteThickness[1.6]], {
                    LineBox[{{0, 10}, {20, 10}}]}}, {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.231], 
                    RGBColor[0.363898, 0.618501, 0.782349], 
                    AbsoluteThickness[1.6]], {
                    InsetBox[
                    FormBox[
                    StyleBox["\"\[FilledCircle]\"", 
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.231], 
                    RGBColor[0.363898, 0.618501, 0.782349], 
                    AbsoluteThickness[1.6]], FontSize -> 10, Plain, 
                    StripOnInput -> False], TraditionalForm], 
                    NCache[
                    Scaled[{
                    Rational[1, 2], 
                    Rational[1, 2]}], 
                    Scaled[{0.5, 0.5}]]]}}}, AspectRatio -> Full, 
                    ImageSize -> {20, 10}, PlotRangePadding -> None, 
                    ImagePadding -> Automatic, 
                    BaselinePosition -> (Scaled[0.1] -> Baseline)], #7}, {
                   GraphicsBox[{{
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.231], 
                    RGBColor[1, 0.75, 0], 
                    AbsoluteThickness[1.6]], {
                    LineBox[{{0, 10}, {20, 10}}]}}, {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.231], 
                    RGBColor[1, 0.75, 0], 
                    AbsoluteThickness[1.6]], {
                    InsetBox[
                    FormBox[
                    StyleBox["\"\[FilledCircle]\"", 
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.231], 
                    RGBColor[1, 0.75, 0], 
                    AbsoluteThickness[1.6]], FontSize -> 10, Plain, 
                    StripOnInput -> False], TraditionalForm], 
                    NCache[
                    Scaled[{
                    Rational[1, 2], 
                    Rational[1, 2]}], 
                    Scaled[{0.5, 0.5}]]]}}}, AspectRatio -> Full, 
                    ImageSize -> {20, 10}, PlotRangePadding -> None, 
                    ImagePadding -> Automatic, 
                    BaselinePosition -> (Scaled[0.1] -> Baseline)], #8}}, 
                 GridBoxAlignment -> {
                  "Columns" -> {Center, Left}, "Rows" -> {{Baseline}}}, 
                 AutoDelete -> False, 
                 GridBoxDividers -> {
                  "Columns" -> {{False}}, "Rows" -> {{False}}}, 
                 GridBoxItemSize -> {"Columns" -> {{All}}, "Rows" -> {{All}}},
                  GridBoxSpacings -> {
                  "Columns" -> {{0.5}}, "Rows" -> {{0.8}}}], "Grid"]}}, 
             GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
             AutoDelete -> False, 
             GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{1}}, "Rows" -> {{0}}}], 
            "Grid"], Alignment -> Left, AppearanceElements -> None, 
           ImageMargins -> {{5, 5}, {5, 5}}, ImageSizeAction -> 
           "ResizeToFit"], LineIndent -> 0, StripOnInput -> False], {
          Directive["Large"], FontFamily -> "Arial"}, Background -> Automatic,
          StripOnInput -> False], TraditionalForm]& ), 
      InterpretationFunction :> (RowBox[{"PointLegend", "[", 
         RowBox[{
           RowBox[{"{", 
             RowBox[{
               RowBox[{"Directive", "[", 
                 RowBox[{
                   RowBox[{"PointSize", "[", "0.012833333333333334`", "]"}], 
                   ",", 
                   InterpretationBox[
                    ButtonBox[
                    TooltipBox[
                    GraphicsBox[{{
                    GrayLevel[0], 
                    RectangleBox[{0, 0}]}, {
                    GrayLevel[0], 
                    RectangleBox[{1, -1}]}, {
                    RGBColor[0.368417, 0.506779, 0.709798], 
                    RectangleBox[{0, -1}, {2, 1}]}}, AspectRatio -> 1, Frame -> 
                    True, FrameStyle -> 
                    RGBColor[
                    0.24561133333333335`, 0.3378526666666667, 
                    0.4731986666666667], FrameTicks -> None, PlotRangePadding -> 
                    None, ImageSize -> 
                    Dynamic[{
                    Automatic, 1.35 CurrentValue["FontCapHeight"]/
                    AbsoluteCurrentValue[Magnification]}]], 
                    "RGBColor[0.368417, 0.506779, 0.709798]"], Appearance -> 
                    None, BaseStyle -> {}, BaselinePosition -> Baseline, 
                    DefaultBaseStyle -> {}, ButtonFunction :> 
                    With[{Typeset`box$ = EvaluationBox[]}, 
                    If[
                    Not[
                    AbsoluteCurrentValue["Deployed"]], 
                    SelectionMove[Typeset`box$, All, Expression]; 
                    FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
                    FrontEnd`Private`$ColorSelectorInitialColor = 
                    RGBColor[0.368417, 0.506779, 0.709798]; 
                    FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
                    MathLink`CallFrontEnd[
                    FrontEnd`AttachCell[Typeset`box$, 
                    FrontEndResource["RGBColorValueSelector"], {
                    0, {Left, Bottom}}, {Left, Top}, 
                    "ClosingActions" -> {
                    "SelectionDeparture", "ParentChanged", 
                    "EvaluatorQuit"}]]]], BaseStyle -> Inherited, Evaluator -> 
                    Automatic, Method -> "Preemptive"], 
                    RGBColor[0.368417, 0.506779, 0.709798], Editable -> False,
                     Selectable -> False], ",", 
                   RowBox[{"AbsoluteThickness", "[", "1.6`", "]"}]}], "]"}], 
               ",", 
               RowBox[{"Directive", "[", 
                 RowBox[{
                   RowBox[{"PointSize", "[", "0.012833333333333334`", "]"}], 
                   ",", 
                   InterpretationBox[
                    ButtonBox[
                    TooltipBox[
                    GraphicsBox[{{
                    GrayLevel[0], 
                    RectangleBox[{0, 0}]}, {
                    GrayLevel[0], 
                    RectangleBox[{1, -1}]}, {
                    RGBColor[0.880722, 0.611041, 0.142051], 
                    RectangleBox[{0, -1}, {2, 1}]}}, AspectRatio -> 1, Frame -> 
                    True, FrameStyle -> 
                    RGBColor[
                    0.587148, 0.40736066666666665`, 0.09470066666666668], 
                    FrameTicks -> None, PlotRangePadding -> None, ImageSize -> 
                    Dynamic[{
                    Automatic, 1.35 CurrentValue["FontCapHeight"]/
                    AbsoluteCurrentValue[Magnification]}]], 
                    "RGBColor[0.880722, 0.611041, 0.142051]"], Appearance -> 
                    None, BaseStyle -> {}, BaselinePosition -> Baseline, 
                    DefaultBaseStyle -> {}, ButtonFunction :> 
                    With[{Typeset`box$ = EvaluationBox[]}, 
                    If[
                    Not[
                    AbsoluteCurrentValue["Deployed"]], 
                    SelectionMove[Typeset`box$, All, Expression]; 
                    FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
                    FrontEnd`Private`$ColorSelectorInitialColor = 
                    RGBColor[0.880722, 0.611041, 0.142051]; 
                    FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
                    MathLink`CallFrontEnd[
                    FrontEnd`AttachCell[Typeset`box$, 
                    FrontEndResource["RGBColorValueSelector"], {
                    0, {Left, Bottom}}, {Left, Top}, 
                    "ClosingActions" -> {
                    "SelectionDeparture", "ParentChanged", 
                    "EvaluatorQuit"}]]]], BaseStyle -> Inherited, Evaluator -> 
                    Automatic, Method -> "Preemptive"], 
                    RGBColor[0.880722, 0.611041, 0.142051], Editable -> False,
                     Selectable -> False], ",", 
                   RowBox[{"AbsoluteThickness", "[", "1.6`", "]"}]}], "]"}], 
               ",", 
               RowBox[{"Directive", "[", 
                 RowBox[{
                   RowBox[{"PointSize", "[", "0.012833333333333334`", "]"}], 
                   ",", 
                   InterpretationBox[
                    ButtonBox[
                    TooltipBox[
                    GraphicsBox[{{
                    GrayLevel[0], 
                    RectangleBox[{0, 0}]}, {
                    GrayLevel[0], 
                    RectangleBox[{1, -1}]}, {
                    RGBColor[0.560181, 0.691569, 0.194885], 
                    RectangleBox[{0, -1}, {2, 1}]}}, AspectRatio -> 1, Frame -> 
                    True, FrameStyle -> 
                    RGBColor[
                    0.37345400000000006`, 0.461046, 0.12992333333333334`], 
                    FrameTicks -> None, PlotRangePadding -> None, ImageSize -> 
                    Dynamic[{
                    Automatic, 1.35 CurrentValue["FontCapHeight"]/
                    AbsoluteCurrentValue[Magnification]}]], 
                    "RGBColor[0.560181, 0.691569, 0.194885]"], Appearance -> 
                    None, BaseStyle -> {}, BaselinePosition -> Baseline, 
                    DefaultBaseStyle -> {}, ButtonFunction :> 
                    With[{Typeset`box$ = EvaluationBox[]}, 
                    If[
                    Not[
                    AbsoluteCurrentValue["Deployed"]], 
                    SelectionMove[Typeset`box$, All, Expression]; 
                    FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
                    FrontEnd`Private`$ColorSelectorInitialColor = 
                    RGBColor[0.560181, 0.691569, 0.194885]; 
                    FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
                    MathLink`CallFrontEnd[
                    FrontEnd`AttachCell[Typeset`box$, 
                    FrontEndResource["RGBColorValueSelector"], {
                    0, {Left, Bottom}}, {Left, Top}, 
                    "ClosingActions" -> {
                    "SelectionDeparture", "ParentChanged", 
                    "EvaluatorQuit"}]]]], BaseStyle -> Inherited, Evaluator -> 
                    Automatic, Method -> "Preemptive"], 
                    RGBColor[0.560181, 0.691569, 0.194885], Editable -> False,
                     Selectable -> False], ",", 
                   RowBox[{"AbsoluteThickness", "[", "1.6`", "]"}]}], "]"}], 
               ",", 
               RowBox[{"Directive", "[", 
                 RowBox[{
                   RowBox[{"PointSize", "[", "0.012833333333333334`", "]"}], 
                   ",", 
                   InterpretationBox[
                    ButtonBox[
                    TooltipBox[
                    GraphicsBox[{{
                    GrayLevel[0], 
                    RectangleBox[{0, 0}]}, {
                    GrayLevel[0], 
                    RectangleBox[{1, -1}]}, {
                    RGBColor[0.922526, 0.385626, 0.209179], 
                    RectangleBox[{0, -1}, {2, 1}]}}, AspectRatio -> 1, Frame -> 
                    True, FrameStyle -> 
                    RGBColor[
                    0.6150173333333333, 0.25708400000000003`, 
                    0.13945266666666667`], FrameTicks -> None, 
                    PlotRangePadding -> None, ImageSize -> 
                    Dynamic[{
                    Automatic, 1.35 CurrentValue["FontCapHeight"]/
                    AbsoluteCurrentValue[Magnification]}]], 
                    "RGBColor[0.922526, 0.385626, 0.209179]"], Appearance -> 
                    None, BaseStyle -> {}, BaselinePosition -> Baseline, 
                    DefaultBaseStyle -> {}, ButtonFunction :> 
                    With[{Typeset`box$ = EvaluationBox[]}, 
                    If[
                    Not[
                    AbsoluteCurrentValue["Deployed"]], 
                    SelectionMove[Typeset`box$, All, Expression]; 
                    FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
                    FrontEnd`Private`$ColorSelectorInitialColor = 
                    RGBColor[0.922526, 0.385626, 0.209179]; 
                    FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
                    MathLink`CallFrontEnd[
                    FrontEnd`AttachCell[Typeset`box$, 
                    FrontEndResource["RGBColorValueSelector"], {
                    0, {Left, Bottom}}, {Left, Top}, 
                    "ClosingActions" -> {
                    "SelectionDeparture", "ParentChanged", 
                    "EvaluatorQuit"}]]]], BaseStyle -> Inherited, Evaluator -> 
                    Automatic, Method -> "Preemptive"], 
                    RGBColor[0.922526, 0.385626, 0.209179], Editable -> False,
                     Selectable -> False], ",", 
                   RowBox[{"AbsoluteThickness", "[", "1.6`", "]"}]}], "]"}], 
               ",", 
               RowBox[{"Directive", "[", 
                 RowBox[{
                   RowBox[{"PointSize", "[", "0.012833333333333334`", "]"}], 
                   ",", 
                   InterpretationBox[
                    ButtonBox[
                    TooltipBox[
                    GraphicsBox[{{
                    GrayLevel[0], 
                    RectangleBox[{0, 0}]}, {
                    GrayLevel[0], 
                    RectangleBox[{1, -1}]}, {
                    RGBColor[0.528488, 0.470624, 0.701351], 
                    RectangleBox[{0, -1}, {2, 1}]}}, AspectRatio -> 1, Frame -> 
                    True, FrameStyle -> 
                    RGBColor[
                    0.3523253333333333, 0.3137493333333333, 
                    0.46756733333333333`], FrameTicks -> None, 
                    PlotRangePadding -> None, ImageSize -> 
                    Dynamic[{
                    Automatic, 1.35 CurrentValue["FontCapHeight"]/
                    AbsoluteCurrentValue[Magnification]}]], 
                    "RGBColor[0.528488, 0.470624, 0.701351]"], Appearance -> 
                    None, BaseStyle -> {}, BaselinePosition -> Baseline, 
                    DefaultBaseStyle -> {}, ButtonFunction :> 
                    With[{Typeset`box$ = EvaluationBox[]}, 
                    If[
                    Not[
                    AbsoluteCurrentValue["Deployed"]], 
                    SelectionMove[Typeset`box$, All, Expression]; 
                    FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
                    FrontEnd`Private`$ColorSelectorInitialColor = 
                    RGBColor[0.528488, 0.470624, 0.701351]; 
                    FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
                    MathLink`CallFrontEnd[
                    FrontEnd`AttachCell[Typeset`box$, 
                    FrontEndResource["RGBColorValueSelector"], {
                    0, {Left, Bottom}}, {Left, Top}, 
                    "ClosingActions" -> {
                    "SelectionDeparture", "ParentChanged", 
                    "EvaluatorQuit"}]]]], BaseStyle -> Inherited, Evaluator -> 
                    Automatic, Method -> "Preemptive"], 
                    RGBColor[0.528488, 0.470624, 0.701351], Editable -> False,
                     Selectable -> False], ",", 
                   RowBox[{"AbsoluteThickness", "[", "1.6`", "]"}]}], "]"}], 
               ",", 
               RowBox[{"Directive", "[", 
                 RowBox[{
                   RowBox[{"PointSize", "[", "0.012833333333333334`", "]"}], 
                   ",", 
                   InterpretationBox[
                    ButtonBox[
                    TooltipBox[
                    GraphicsBox[{{
                    GrayLevel[0], 
                    RectangleBox[{0, 0}]}, {
                    GrayLevel[0], 
                    RectangleBox[{1, -1}]}, {
                    RGBColor[0.772079, 0.431554, 0.102387], 
                    RectangleBox[{0, -1}, {2, 1}]}}, AspectRatio -> 1, Frame -> 
                    True, FrameStyle -> 
                    RGBColor[
                    0.5147193333333333, 0.28770266666666666`, 
                    0.06825800000000001], FrameTicks -> None, 
                    PlotRangePadding -> None, ImageSize -> 
                    Dynamic[{
                    Automatic, 1.35 CurrentValue["FontCapHeight"]/
                    AbsoluteCurrentValue[Magnification]}]], 
                    "RGBColor[0.772079, 0.431554, 0.102387]"], Appearance -> 
                    None, BaseStyle -> {}, BaselinePosition -> Baseline, 
                    DefaultBaseStyle -> {}, ButtonFunction :> 
                    With[{Typeset`box$ = EvaluationBox[]}, 
                    If[
                    Not[
                    AbsoluteCurrentValue["Deployed"]], 
                    SelectionMove[Typeset`box$, All, Expression]; 
                    FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
                    FrontEnd`Private`$ColorSelectorInitialColor = 
                    RGBColor[0.772079, 0.431554, 0.102387]; 
                    FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
                    MathLink`CallFrontEnd[
                    FrontEnd`AttachCell[Typeset`box$, 
                    FrontEndResource["RGBColorValueSelector"], {
                    0, {Left, Bottom}}, {Left, Top}, 
                    "ClosingActions" -> {
                    "SelectionDeparture", "ParentChanged", 
                    "EvaluatorQuit"}]]]], BaseStyle -> Inherited, Evaluator -> 
                    Automatic, Method -> "Preemptive"], 
                    RGBColor[0.772079, 0.431554, 0.102387], Editable -> False,
                     Selectable -> False], ",", 
                   RowBox[{"AbsoluteThickness", "[", "1.6`", "]"}]}], "]"}], 
               ",", 
               RowBox[{"Directive", "[", 
                 RowBox[{
                   RowBox[{"PointSize", "[", "0.012833333333333334`", "]"}], 
                   ",", 
                   InterpretationBox[
                    ButtonBox[
                    TooltipBox[
                    GraphicsBox[{{
                    GrayLevel[0], 
                    RectangleBox[{0, 0}]}, {
                    GrayLevel[0], 
                    RectangleBox[{1, -1}]}, {
                    RGBColor[0.363898, 0.618501, 0.782349], 
                    RectangleBox[{0, -1}, {2, 1}]}}, AspectRatio -> 1, Frame -> 
                    True, FrameStyle -> 
                    RGBColor[0.24259866666666668`, 0.412334, 0.521566], 
                    FrameTicks -> None, PlotRangePadding -> None, ImageSize -> 
                    Dynamic[{
                    Automatic, 1.35 CurrentValue["FontCapHeight"]/
                    AbsoluteCurrentValue[Magnification]}]], 
                    "RGBColor[0.363898, 0.618501, 0.782349]"], Appearance -> 
                    None, BaseStyle -> {}, BaselinePosition -> Baseline, 
                    DefaultBaseStyle -> {}, ButtonFunction :> 
                    With[{Typeset`box$ = EvaluationBox[]}, 
                    If[
                    Not[
                    AbsoluteCurrentValue["Deployed"]], 
                    SelectionMove[Typeset`box$, All, Expression]; 
                    FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
                    FrontEnd`Private`$ColorSelectorInitialColor = 
                    RGBColor[0.363898, 0.618501, 0.782349]; 
                    FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
                    MathLink`CallFrontEnd[
                    FrontEnd`AttachCell[Typeset`box$, 
                    FrontEndResource["RGBColorValueSelector"], {
                    0, {Left, Bottom}}, {Left, Top}, 
                    "ClosingActions" -> {
                    "SelectionDeparture", "ParentChanged", 
                    "EvaluatorQuit"}]]]], BaseStyle -> Inherited, Evaluator -> 
                    Automatic, Method -> "Preemptive"], 
                    RGBColor[0.363898, 0.618501, 0.782349], Editable -> False,
                     Selectable -> False], ",", 
                   RowBox[{"AbsoluteThickness", "[", "1.6`", "]"}]}], "]"}], 
               ",", 
               RowBox[{"Directive", "[", 
                 RowBox[{
                   RowBox[{"PointSize", "[", "0.012833333333333334`", "]"}], 
                   ",", 
                   InterpretationBox[
                    ButtonBox[
                    TooltipBox[
                    GraphicsBox[{{
                    GrayLevel[0], 
                    RectangleBox[{0, 0}]}, {
                    GrayLevel[0], 
                    RectangleBox[{1, -1}]}, {
                    RGBColor[1, 0.75, 0], 
                    RectangleBox[{0, -1}, {2, 1}]}}, AspectRatio -> 1, Frame -> 
                    True, FrameStyle -> RGBColor[0.6666666666666666, 0.5, 0.],
                     FrameTicks -> None, PlotRangePadding -> None, ImageSize -> 
                    Dynamic[{
                    Automatic, 1.35 CurrentValue["FontCapHeight"]/
                    AbsoluteCurrentValue[Magnification]}]], 
                    "RGBColor[1, 0.75, 0]"], Appearance -> None, 
                    BaseStyle -> {}, BaselinePosition -> Baseline, 
                    DefaultBaseStyle -> {}, ButtonFunction :> 
                    With[{Typeset`box$ = EvaluationBox[]}, 
                    If[
                    Not[
                    AbsoluteCurrentValue["Deployed"]], 
                    SelectionMove[Typeset`box$, All, Expression]; 
                    FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
                    FrontEnd`Private`$ColorSelectorInitialColor = 
                    RGBColor[1, 0.75, 0]; 
                    FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
                    MathLink`CallFrontEnd[
                    FrontEnd`AttachCell[Typeset`box$, 
                    FrontEndResource["RGBColorValueSelector"], {
                    0, {Left, Bottom}}, {Left, Top}, 
                    "ClosingActions" -> {
                    "SelectionDeparture", "ParentChanged", 
                    "EvaluatorQuit"}]]]], BaseStyle -> Inherited, Evaluator -> 
                    Automatic, Method -> "Preemptive"], 
                    RGBColor[1, 0.75, 0], Editable -> False, Selectable -> 
                    False], ",", 
                   RowBox[{"AbsoluteThickness", "[", "1.6`", "]"}]}], "]"}]}],
              "}"}], ",", 
           RowBox[{"{", 
             
             RowBox[{#, ",", #2, ",", #3, ",", #4, ",", #5, ",", #6, ",", #7, 
               ",", #8}], "}"}], ",", 
           RowBox[{"LegendMarkers", "\[Rule]", 
             RowBox[{"{", 
               RowBox[{
                 RowBox[{"{", 
                   RowBox[{"\"\[FilledCircle]\"", ",", "Automatic"}], "}"}], 
                 ",", 
                 RowBox[{"{", 
                   RowBox[{"\"\[FilledCircle]\"", ",", "Automatic"}], "}"}], 
                 ",", 
                 RowBox[{"{", 
                   RowBox[{"\"\[FilledCircle]\"", ",", "Automatic"}], "}"}], 
                 ",", 
                 RowBox[{"{", 
                   RowBox[{"\"\[FilledCircle]\"", ",", "Automatic"}], "}"}], 
                 ",", 
                 RowBox[{"{", 
                   RowBox[{"\"\[FilledCircle]\"", ",", "Automatic"}], "}"}], 
                 ",", 
                 RowBox[{"{", 
                   RowBox[{"\"\[FilledCircle]\"", ",", "Automatic"}], "}"}], 
                 ",", 
                 RowBox[{"{", 
                   RowBox[{"\"\[FilledCircle]\"", ",", "Automatic"}], "}"}], 
                 ",", 
                 RowBox[{"{", 
                   RowBox[{"\"\[FilledCircle]\"", ",", "Automatic"}], "}"}]}],
                "}"}]}], ",", 
           RowBox[{"Joined", "\[Rule]", 
             RowBox[{"{", 
               
               RowBox[{
                "True", ",", "True", ",", "True", ",", "True", ",", "True", 
                 ",", "True", ",", "True", ",", "True"}], "}"}]}], ",", 
           RowBox[{"LabelStyle", "\[Rule]", 
             RowBox[{"Directive", "[", "\"Large\"", "]"}]}], ",", 
           RowBox[{"LegendLayout", "\[Rule]", "\"Column\""}]}], "]"}]& ), 
      Editable -> True], TraditionalForm], TraditionalForm]},
  "Legended",
  DisplayFunction->(GridBox[{{
      TagBox[
       ItemBox[
        PaneBox[
         TagBox[#, "SkipImageSizeLevel"], Alignment -> {Center, Baseline}, 
         BaselinePosition -> Baseline], DefaultBaseStyle -> "Labeled"], 
       "SkipImageSizeLevel"], 
      ItemBox[#2, DefaultBaseStyle -> "LabeledLabel"]}}, 
    GridBoxAlignment -> {"Columns" -> {{Center}}, "Rows" -> {{Center}}}, 
    AutoDelete -> False, GridBoxItemSize -> Automatic, 
    BaselinePosition -> {1, 1}]& ),
  Editable->True,
  InterpretationFunction->(RowBox[{"Legended", "[", 
     RowBox[{#, ",", 
       RowBox[{"Placed", "[", 
         RowBox[{#2, ",", "After"}], "]"}]}], "]"}]& )]], "Output",
 CellChangeTimes->{
  3.708933661872147*^9, {3.708933745104457*^9, 3.7089337614486856`*^9}, {
   3.708933804602512*^9, 3.708933835634268*^9}, {3.70893397684991*^9, 
   3.70893402128274*^9}, 3.708934059691798*^9, {3.708934109265952*^9, 
   3.708934157022612*^9}, 3.7089342337436237`*^9, {3.708934271658646*^9, 
   3.708934338584794*^9}, 3.708934470139324*^9, 3.7089350986931353`*^9, 
   3.708935145159827*^9, 3.708935929122879*^9, 3.708977521890115*^9, 
   3.708977598230517*^9, 3.7089776674811*^9, 3.708977899577642*^9, 
   3.7089780453099546`*^9, 3.7089782485490522`*^9, 3.709290346693345*^9, {
   3.7092903901507397`*^9, 3.709290520372593*^9}, {3.709290574645994*^9, 
   3.7092906189418287`*^9}, {3.709290668020727*^9, 3.709290673761735*^9}, {
   3.709290856241283*^9, 3.709290879049629*^9}, 3.709290927432205*^9, 
   3.709290962333797*^9, {3.709291057514572*^9, 3.709291153632311*^9}, {
   3.709291273004285*^9, 3.709291379322954*^9}, {3.7092914213908587`*^9, 
   3.7092914456133633`*^9}, {3.709291500379406*^9, 3.70929151282172*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"prm", "=", 
   RowBox[{"Max", "[", 
    RowBox[{"prob", "[", 
     RowBox[{"[", 
      RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"ListPlot", "[", 
    RowBox[{
     RowBox[{"prob", "[", 
      RowBox[{"[", 
       RowBox[{"m", "+", "1"}], "]"}], "]"}], ",", 
     RowBox[{"Joined", "\[Rule]", "True"}], ",", 
     RowBox[{"PlotMarkers", "\[Rule]", 
      RowBox[{"{", "\"\<\[FilledCircle]\>\"", "}"}]}], ",", 
     RowBox[{"PlotRange", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "M"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "prm"}], "}"}]}], "}"}]}]}], "]"}], 
   "\[IndentingNewLine]", ",", 
   RowBox[{"{", 
    RowBox[{"m", ",", "0", ",", "mmax", ",", "1"}], "}"}]}], "]"}]}], "Input",\

 CellChangeTimes->{{3.708931525512191*^9, 3.708931574936512*^9}, {
   3.708931629177392*^9, 3.708931721709196*^9}, {3.708931951496661*^9, 
   3.708931955873351*^9}, 3.7089351467421703`*^9, 3.708977545317872*^9}],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`m$$ = 0, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{
      Hold[$CellContext`m$$], 0, 20, 1}}, Typeset`size$$ = {
    540., {150., 157.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = True, $CellContext`m$109277$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, "Variables" :> {$CellContext`m$$ = 0}, 
      "ControllerVariables" :> {
        Hold[$CellContext`m$$, $CellContext`m$109277$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> ListPlot[
        Part[$CellContext`prob, $CellContext`m$$ + 1], Joined -> True, 
        PlotMarkers -> {"\[FilledCircle]"}, 
        PlotRange -> {{0, $CellContext`M}, {0, $CellContext`prm}}], 
      "Specifications" :> {{$CellContext`m$$, 0, 20, 1}}, "Options" :> {}, 
      "DefaultOptions" :> {}],
     ImageSizeCache->{606., {209., 217.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{3.708977547988646*^9, 3.7089776033432493`*^9, 
  3.7089776720379953`*^9, 3.708977773219234*^9, 3.7089779045095463`*^9, 
  3.708978065966997*^9, 3.708978250509315*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Part", "::", "partd"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Part specification \
\[NoBreak]\\!\\(\\*RowBox[{\\\"prob\\\", \\\"\[LeftDoubleBracket]\\\", \
\\\"1\\\", \\\"\[RightDoubleBracket]\\\"}]\\)\[NoBreak] is longer than depth \
of object. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\
\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/partd\\\", ButtonNote -> \
\\\"Part::partd\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.709290173081069*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Part", "::", "partd"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Part specification \
\[NoBreak]\\!\\(\\*RowBox[{\\\"prob\\\", \\\"\[LeftDoubleBracket]\\\", \
\\\"1\\\", \\\"\[RightDoubleBracket]\\\"}]\\)\[NoBreak] is longer than depth \
of object. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\
\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/partd\\\", ButtonNote -> \
\\\"Part::partd\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.7092901731440773`*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"ListPlot", "::", "prng"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Value of option PlotRange -> \[NoBreak]\\!\\(\\*RowBox[{\\\
\"{\\\", RowBox[{RowBox[{\\\"{\\\", RowBox[{\\\"0\\\", \\\",\\\", \
\\\"M\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\"0\\\", \\\
\",\\\", \\\"prm\\\"}], \\\"}\\\"}]}], \\\"}\\\"}]\\)\[NoBreak] is not All, \
Full, Automatic, a positive machine number, or an appropriate list of range \
specifications. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/ListPlot\\\", ButtonNote -> \
\\\"ListPlot::prng\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.709290173445126*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"ListPlot", "::", "lpn"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"\[NoBreak]\\!\\(\\*RowBox[{\\\"prob\\\", \\\"\
\[LeftDoubleBracket]\\\", \\\"1\\\", \\\"\[RightDoubleBracket]\\\"}]\\)\
\[NoBreak] is not a list of numbers or pairs of numbers. \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/ListPlot\\\", ButtonNote -> \
\\\"ListPlot::lpn\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.709290173552209*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"ListPlot", "::", "prng"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Value of option PlotRange -> \[NoBreak]\\!\\(\\*RowBox[{\\\
\"{\\\", RowBox[{RowBox[{\\\"{\\\", RowBox[{\\\"0\\\", \\\",\\\", \
\\\"M\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\"0\\\", \\\
\",\\\", \\\"prm\\\"}], \\\"}\\\"}]}], \\\"}\\\"}]\\)\[NoBreak] is not All, \
Full, Automatic, a positive machine number, or an appropriate list of range \
specifications. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/ListPlot\\\", ButtonNote -> \
\\\"ListPlot::prng\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.709290173669044*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"ListPlot", "::", "lpn"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"\[NoBreak]\\!\\(\\*RowBox[{\\\"prob\\\", \\\"\
\[LeftDoubleBracket]\\\", \\\"1\\\", \\\"\[RightDoubleBracket]\\\"}]\\)\
\[NoBreak] is not a list of numbers or pairs of numbers. \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/ListPlot\\\", ButtonNote -> \
\\\"ListPlot::lpn\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.7092901737552843`*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"ListPlot", "::", "prng"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Value of option PlotRange -> \[NoBreak]\\!\\(\\*RowBox[{\\\
\"{\\\", RowBox[{RowBox[{\\\"{\\\", RowBox[{\\\"0\\\", \\\",\\\", \
\\\"M\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\"0\\\", \\\
\",\\\", \\\"prm\\\"}], \\\"}\\\"}]}], \\\"}\\\"}]\\)\[NoBreak] is not All, \
Full, Automatic, a positive machine number, or an appropriate list of range \
specifications. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/ListPlot\\\", ButtonNote -> \
\\\"ListPlot::prng\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.7092901738549557`*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"General", "::", "stop"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Further output of \
\[NoBreak]\\!\\(\\*StyleBox[RowBox[{\\\"ListPlot\\\", \\\"::\\\", \
\\\"prng\\\"}], \\\"MessageName\\\"]\\)\[NoBreak] will be suppressed during \
this calculation. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/stop\\\", ButtonNote -> \
\\\"General::stop\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.7092901739138803`*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"ListPlot", "::", "lpn"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"\[NoBreak]\\!\\(\\*RowBox[{\\\"prob\\\", \\\"\
\[LeftDoubleBracket]\\\", \\\"1\\\", \\\"\[RightDoubleBracket]\\\"}]\\)\
\[NoBreak] is not a list of numbers or pairs of numbers. \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/ListPlot\\\", ButtonNote -> \
\\\"ListPlot::lpn\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.7092901740022583`*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"General", "::", "stop"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Further output of \
\[NoBreak]\\!\\(\\*StyleBox[RowBox[{\\\"ListPlot\\\", \\\"::\\\", \
\\\"lpn\\\"}], \\\"MessageName\\\"]\\)\[NoBreak] will be suppressed during \
this calculation. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/stop\\\", ButtonNote -> \
\\\"General::stop\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.70929017406143*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"ListPlot", "::", "prng"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Value of option PlotRange -> \[NoBreak]\\!\\(\\*RowBox[{\\\
\"{\\\", RowBox[{RowBox[{\\\"{\\\", RowBox[{\\\"0\\\", \\\",\\\", \
\\\"5\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\"0\\\", \\\
\",\\\", \\\"prm\\\"}], \\\"}\\\"}]}], \\\"}\\\"}]\\)\[NoBreak] is not All, \
Full, Automatic, a positive machine number, or an appropriate list of range \
specifications. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/ListPlot\\\", ButtonNote -> \
\\\"ListPlot::prng\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.70929023353078*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"wv", "=", "0.2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gg", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"lam", "=", "2"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"M", "=", "5"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Nmax", "=", "5"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"m", "=", "3"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"prob", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"ntot", "=", 
       RowBox[{
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{"c", "[", 
           RowBox[{"NN", ",", "i"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "0", ",", 
            RowBox[{"Min", "[", 
             RowBox[{"m", ",", "NN"}], "]"}]}], "}"}]}], "]"}], " ", "*", " ", 
        RowBox[{"M", "^", "NN"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"wvlam", "=", 
       RowBox[{"wv", "*", "lam"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"H", " ", "=", " ", 
       RowBox[{
        RowBox[{"wv", "*", 
         RowBox[{"makeHv", "[", 
          RowBox[{"NN", ",", "M", ",", "m"}], "]"}]}], " ", "+", " ", 
        RowBox[{"makeHg", "[", 
         RowBox[{"NN", ",", "M", ",", "m", ",", "gg"}], "]"}], " ", "+", " ", 
        
        RowBox[{"wvlam", "*", 
         RowBox[{"makeHb", "[", 
          RowBox[{"NN", ",", "M", ",", "m"}], "]"}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"nn", "=", 
       RowBox[{"Norm", "[", 
        RowBox[{"Flatten", "[", "H", "]"}], "]"}]}], ";", "\n", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"eval", ",", "evec"}], "}"}], "=", 
       RowBox[{"Eigensystem", "[", 
        RowBox[{
         RowBox[{"H", "-", 
          RowBox[{"nn", "*", 
           RowBox[{"SparseArray", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Band", "[", 
                RowBox[{"{", 
                 RowBox[{"1", ",", "1"}], "}"}], "]"}], "\[Rule]", "1"}], 
              "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"ntot", ",", "ntot"}], "}"}]}], "]"}]}]}], ",", "1"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"eval", "=", 
       RowBox[{"eval", "+", "nn"}]}], ";", 
      RowBox[{"eval", "//", "Print"}], ";", "\[IndentingNewLine]", 
      RowBox[{"pr", "=", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"Probvib1dn", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"evec", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "//", "Chop"}], ",", "NN", ",", 
           "m", ",", "M"}], "]"}], "}"}], "//", "Transpose"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"pr2", "=", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"Table", "[", 
            RowBox[{"i", ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "0", ",", 
               RowBox[{"M", "-", "1"}]}], "}"}]}], "]"}], "}"}], "//", 
          "Transpose"}], ",", "pr", ",", "2"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"AppendTo", "[", 
       RowBox[{"prob", ",", "pr2"}], "]"}], ";"}], "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{"NN", ",", "2", ",", "Nmax"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"labels", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"\"\<N = \>\"", "<>", 
      RowBox[{"ToString", "[", "i", "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "2", ",", "Nmax"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"ListPlot", "[", 
  RowBox[{"prob", ",", 
   RowBox[{"Joined", "\[Rule]", "True"}], ",", 
   RowBox[{"PlotMarkers", "\[Rule]", 
    RowBox[{"{", "\"\<\[FilledCircle]\>\"", "}"}]}], ",", 
   RowBox[{"PlotLegends", "\[Rule]", 
    RowBox[{"Placed", "[", 
     RowBox[{"labels", ",", "Right"}], "]"}]}], ",", 
   RowBox[{
   "PlotLabel", "\[Rule]", 
    "\"\<Vibrational occupations for a down spin for different number of m=\!\
\(\*SubscriptBox[\(n\), \(exciton\)]\)+\!\(\*SubscriptBox[\(n\), \
\(photon\)]\)\>\""}], ",", "\[IndentingNewLine]", 
   RowBox[{"Epilog", "\[Rule]", 
    RowBox[{"Inset", "[", 
     RowBox[{
      RowBox[{"Text", "[", 
       RowBox[{"\"\<m=\>\"", "<>", 
        RowBox[{"ToString", "[", "m", "]"}], "<>", 
        "\"\<, \!\(\*SubscriptBox[\(\[Omega]\), \(v\)]\)=0.2, \
\!\(\*SubscriptBox[\(\[Omega]\), \(R\)]\)=1, \
\!\(\*SubscriptBox[\(\[Lambda]\), \(0\)]\)=\>\"", "<>", 
        RowBox[{"ToString", "[", "lam", "]"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "0.7"}], "}"}]}], "]"}]}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"ImageSize", "\[Rule]", "500"}], ",", 
   RowBox[{"Axes", "\[Rule]", "False"}], ",", 
   RowBox[{"Frame", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"True", ",", "False"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
   RowBox[{"FrameLabel", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "\"\<\!\(\*SubscriptBox[\(P\), SubscriptBox[\(n\), \(v\)]]\)\>\"", ",",
         "None"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"\"\<\!\(\*SubscriptBox[\(n\), \(v\)]\)\>\"", ",", "None"}], 
       "}"}]}], "}"}]}], ",", 
   RowBox[{"FrameTicks", "\[Rule]", "All"}]}], "\[IndentingNewLine]", 
  "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.708934592841263*^9, 3.7089347034087*^9}, {
  3.708934801834388*^9, 3.7089348133734827`*^9}, {3.708935229844735*^9, 
  3.708935235226801*^9}, {3.70893528311609*^9, 3.70893529062707*^9}, {
  3.708943006486392*^9, 3.708943043858876*^9}, {3.7089430929257*^9, 
  3.7089431167931957`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"-", "5.039525885319726`"}], "}"}]], "Print",
 CellChangeTimes->{
  3.7089347081914883`*^9, 3.708934816255685*^9, 3.708935051838121*^9, 
   3.708935262458138*^9, 3.708935299093751*^9, 3.7089359632093887`*^9, 
   3.708943046033052*^9, {3.708943098136724*^9, 3.7089431185901203`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"-", "6.8097203384476614`"}], "}"}]], "Print",
 CellChangeTimes->{
  3.7089347081914883`*^9, 3.708934816255685*^9, 3.708935051838121*^9, 
   3.708935262458138*^9, 3.708935299093751*^9, 3.7089359632093887`*^9, 
   3.708943046033052*^9, {3.708943098136724*^9, 3.708943118614059*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"-", "7.405682161674633`"}], "}"}]], "Print",
 CellChangeTimes->{
  3.7089347081914883`*^9, 3.708934816255685*^9, 3.708935051838121*^9, 
   3.708935262458138*^9, 3.708935299093751*^9, 3.7089359632093887`*^9, 
   3.708943046033052*^9, {3.708943098136724*^9, 3.708943118922274*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"-", "7.909642329267626`"}], "}"}]], "Print",
 CellChangeTimes->{
  3.7089347081914883`*^9, 3.708934816255685*^9, 3.708935051838121*^9, 
   3.708935262458138*^9, 3.708935299093751*^9, 3.7089359632093887`*^9, 
   3.708943046033052*^9, {3.708943098136724*^9, 3.708943123235523*^9}}]
}, Open  ]],

Cell[BoxData[
 TemplateBox[{GraphicsBox[{{}, {{{}, {}, {
        Hue[0.67, 0.6, 0.6], 
        Directive[
         PointSize[0.012833333333333334`], 
         RGBColor[0.368417, 0.506779, 0.709798], 
         AbsoluteThickness[1.6]], 
        LineBox[{{0., 0.0656622485476094}, {1., 0.2291448150857951}, {2., 
         0.34811965200534395`}, {3., 0.27159978763639125`}, {4., 
         0.08547349672486027}}]}, {
        Hue[0.9060679774997897, 0.6, 0.6], 
        Directive[
         PointSize[0.012833333333333334`], 
         RGBColor[0.880722, 0.611041, 0.142051], 
         AbsoluteThickness[1.6]], 
        LineBox[{{0., 0.07206161256054842}, {1., 0.23827174759398406`}, {2., 
         0.3472717997245088}, {3., 0.2621356428954972}, {4., 
         0.08025919722546143}}]}, {
        Hue[0.1421359549995791, 0.6, 0.6], 
        Directive[
         PointSize[0.012833333333333334`], 
         RGBColor[0.560181, 0.691569, 0.194885], 
         AbsoluteThickness[1.6]], 
        LineBox[{{0., 0.20339986276367575`}, {1., 0.3176470803283264}, {2., 
         0.28452770416301143`}, {3., 0.15567021938649983`}, {4., 
         0.038755133358486515`}}]}, {
        Hue[0.37820393249936934`, 0.6, 0.6], 
        Directive[
         PointSize[0.012833333333333334`], 
         RGBColor[0.922526, 0.385626, 0.209179], 
         AbsoluteThickness[1.6]], 
        LineBox[{{0., 0.33242388959649266`}, {1., 0.3268921283174261}, {2., 
         0.21887977344639575`}, {3., 0.09959038365853966}, {4., 
         0.022213824981145686`}}]}}, {{
        Directive[
         PointSize[0.012833333333333334`], 
         RGBColor[0.368417, 0.506779, 0.709798], 
         AbsoluteThickness[1.6], 
         AbsolutePointSize[6]], 
        GeometricTransformationBox[
         TagBox[
          InsetBox["\[FilledCircle]", {0., 0.}], "InsetString"], {{{0., 
         0.0656622485476094}}, {{1., 0.2291448150857951}}, {{2., 
         0.34811965200534395`}}, {{3., 0.27159978763639125`}}, {{4., 
         0.08547349672486027}}}]}, {
        Directive[
         PointSize[0.012833333333333334`], 
         RGBColor[0.880722, 0.611041, 0.142051], 
         AbsoluteThickness[1.6], 
         AbsolutePointSize[6]], 
        GeometricTransformationBox[
         TagBox[
          InsetBox["\[FilledCircle]", {0., 0.}], "InsetString"], {{{0., 
         0.07206161256054842}}, {{1., 0.23827174759398406`}}, {{2., 
         0.3472717997245088}}, {{3., 0.2621356428954972}}, {{4., 
         0.08025919722546143}}}]}, {
        Directive[
         PointSize[0.012833333333333334`], 
         RGBColor[0.560181, 0.691569, 0.194885], 
         AbsoluteThickness[1.6], 
         AbsolutePointSize[6]], 
        GeometricTransformationBox[
         TagBox[
          InsetBox["\[FilledCircle]", {0., 0.}], "InsetString"], {{{0., 
         0.20339986276367575`}}, {{1., 0.3176470803283264}}, {{2., 
         0.28452770416301143`}}, {{3., 0.15567021938649983`}}, {{4., 
         0.038755133358486515`}}}]}, {
        Directive[
         PointSize[0.012833333333333334`], 
         RGBColor[0.922526, 0.385626, 0.209179], 
         AbsoluteThickness[1.6], 
         AbsolutePointSize[6]], 
        GeometricTransformationBox[
         TagBox[
          InsetBox["\[FilledCircle]", {0., 0.}], "InsetString"], {{{0., 
         0.33242388959649266`}}, {{1., 0.3268921283174261}}, {{2., 
         0.21887977344639575`}}, {{3., 0.09959038365853966}}, {{4., 
         0.022213824981145686`}}}]}, {}}}, {}}, {
    DisplayFunction -> Identity, PlotRangePadding -> {{
        Scaled[0.02], 
        Scaled[0.02]}, {
        Scaled[0.02], 
        Scaled[0.05]}}, AxesOrigin -> {0, 0}, 
     PlotRange -> {{0, 4.}, {0, 0.34811965200534395`}}, PlotRangeClipping -> 
     True, ImagePadding -> All, DisplayFunction -> Identity, AspectRatio -> 
     NCache[GoldenRatio^(-1), 0.6180339887498948], Axes -> {False, False}, 
     AxesLabel -> {None, None}, AxesOrigin -> {0, 0}, DisplayFunction :> 
     Identity, Epilog -> InsetBox[
       BoxData[
        FormBox[
         InterpretationBox[
          Cell[
           BoxData[
            FormBox[
            "\"m=3, \\!\\(\\*SubscriptBox[\\(\[Omega]\\), \\(v\\)]\\)=0.2, \
\\!\\(\\*SubscriptBox[\\(\[Omega]\\), \\(R\\)]\\)=1, \
\\!\\(\\*SubscriptBox[\\(\[Lambda]\\), \\(0\\)]\\)=2\"", TextForm]], 
           "InlineText"], 
          Text[
          "m=3, \!\(\*SubscriptBox[\(\[Omega]\), \(v\)]\)=0.2, \
\!\(\*SubscriptBox[\(\[Omega]\), \(R\)]\)=1, \
\!\(\*SubscriptBox[\(\[Lambda]\), \(0\)]\)=2"]], TraditionalForm]], {1, 0.7}],
      Frame -> {{True, False}, {True, False}}, FrameLabel -> {{
        FormBox[
        "\"\\!\\(\\*SubscriptBox[\\(P\\), SubscriptBox[\\(n\\), \
\\(v\\)]]\\)\"", TraditionalForm], None}, {
        FormBox[
        "\"\\!\\(\\*SubscriptBox[\\(n\\), \\(v\\)]\\)\"", TraditionalForm], 
        None}}, FrameTicks -> {{All, All}, {All, All}}, 
     GridLines -> {None, None}, GridLinesStyle -> Directive[
       GrayLevel[0.5, 0.4]], ImageSize -> 500, 
     Method -> {"CoordinatesToolOptions" -> {"DisplayFunction" -> ({
           (Part[{{Identity, Identity}, {Identity, Identity}}, 1, 2][#]& )[
            Part[#, 1]], 
           (Part[{{Identity, Identity}, {Identity, Identity}}, 2, 2][#]& )[
            Part[#, 2]]}& ), "CopiedValueFunction" -> ({
           (Part[{{Identity, Identity}, {Identity, Identity}}, 1, 2][#]& )[
            Part[#, 1]], 
           (Part[{{Identity, Identity}, {Identity, Identity}}, 2, 2][#]& )[
            Part[#, 2]]}& )}}, PlotLabel -> 
     FormBox["\"Vibrational occupations for a down spin for different number \
of m=\\!\\(\\*SubscriptBox[\\(n\\), \
\\(exciton\\)]\\)+\\!\\(\\*SubscriptBox[\\(n\\), \\(photon\\)]\\)\"", 
       TraditionalForm], PlotRange -> {{0, 4.}, {0, 0.34811965200534395`}}, 
     PlotRangeClipping -> True, PlotRangePadding -> {{
        Scaled[0.02], 
        Scaled[0.02]}, {
        Scaled[0.02], 
        Scaled[0.05]}}, Ticks -> {Automatic, Automatic}}],FormBox[
    FormBox[
     TemplateBox[{"\"N = 2\"", "\"N = 3\"", "\"N = 4\"", "\"N = 5\""}, 
      "PointLegend", DisplayFunction -> (FormBox[
        StyleBox[
         StyleBox[
          PaneBox[
           TagBox[
            GridBox[{{
               TagBox[
                GridBox[{{
                   GraphicsBox[{{
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.231], 
                    RGBColor[0.368417, 0.506779, 0.709798], 
                    AbsoluteThickness[1.6]], {
                    LineBox[{{0, 10}, {20, 10}}]}}, {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.231], 
                    RGBColor[0.368417, 0.506779, 0.709798], 
                    AbsoluteThickness[1.6]], {
                    InsetBox[
                    FormBox[
                    StyleBox["\"\[FilledCircle]\"", 
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.231], 
                    RGBColor[0.368417, 0.506779, 0.709798], 
                    AbsoluteThickness[1.6]], FontSize -> 10, Plain, 
                    StripOnInput -> False], TraditionalForm], 
                    NCache[
                    Scaled[{
                    Rational[1, 2], 
                    Rational[1, 2]}], 
                    Scaled[{0.5, 0.5}]]]}}}, AspectRatio -> Full, 
                    ImageSize -> {20, 10}, PlotRangePadding -> None, 
                    ImagePadding -> Automatic, 
                    BaselinePosition -> (Scaled[0.1] -> Baseline)], #}, {
                   GraphicsBox[{{
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.231], 
                    RGBColor[0.880722, 0.611041, 0.142051], 
                    AbsoluteThickness[1.6]], {
                    LineBox[{{0, 10}, {20, 10}}]}}, {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.231], 
                    RGBColor[0.880722, 0.611041, 0.142051], 
                    AbsoluteThickness[1.6]], {
                    InsetBox[
                    FormBox[
                    StyleBox["\"\[FilledCircle]\"", 
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.231], 
                    RGBColor[0.880722, 0.611041, 0.142051], 
                    AbsoluteThickness[1.6]], FontSize -> 10, Plain, 
                    StripOnInput -> False], TraditionalForm], 
                    NCache[
                    Scaled[{
                    Rational[1, 2], 
                    Rational[1, 2]}], 
                    Scaled[{0.5, 0.5}]]]}}}, AspectRatio -> Full, 
                    ImageSize -> {20, 10}, PlotRangePadding -> None, 
                    ImagePadding -> Automatic, 
                    BaselinePosition -> (Scaled[0.1] -> Baseline)], #2}, {
                   GraphicsBox[{{
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.231], 
                    RGBColor[0.560181, 0.691569, 0.194885], 
                    AbsoluteThickness[1.6]], {
                    LineBox[{{0, 10}, {20, 10}}]}}, {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.231], 
                    RGBColor[0.560181, 0.691569, 0.194885], 
                    AbsoluteThickness[1.6]], {
                    InsetBox[
                    FormBox[
                    StyleBox["\"\[FilledCircle]\"", 
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.231], 
                    RGBColor[0.560181, 0.691569, 0.194885], 
                    AbsoluteThickness[1.6]], FontSize -> 10, Plain, 
                    StripOnInput -> False], TraditionalForm], 
                    NCache[
                    Scaled[{
                    Rational[1, 2], 
                    Rational[1, 2]}], 
                    Scaled[{0.5, 0.5}]]]}}}, AspectRatio -> Full, 
                    ImageSize -> {20, 10}, PlotRangePadding -> None, 
                    ImagePadding -> Automatic, 
                    BaselinePosition -> (Scaled[0.1] -> Baseline)], #3}, {
                   GraphicsBox[{{
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.231], 
                    RGBColor[0.922526, 0.385626, 0.209179], 
                    AbsoluteThickness[1.6]], {
                    LineBox[{{0, 10}, {20, 10}}]}}, {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.231], 
                    RGBColor[0.922526, 0.385626, 0.209179], 
                    AbsoluteThickness[1.6]], {
                    InsetBox[
                    FormBox[
                    StyleBox["\"\[FilledCircle]\"", 
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.231], 
                    RGBColor[0.922526, 0.385626, 0.209179], 
                    AbsoluteThickness[1.6]], FontSize -> 10, Plain, 
                    StripOnInput -> False], TraditionalForm], 
                    NCache[
                    Scaled[{
                    Rational[1, 2], 
                    Rational[1, 2]}], 
                    Scaled[{0.5, 0.5}]]]}}}, AspectRatio -> Full, 
                    ImageSize -> {20, 10}, PlotRangePadding -> None, 
                    ImagePadding -> Automatic, 
                    BaselinePosition -> (Scaled[0.1] -> Baseline)], #4}}, 
                 GridBoxAlignment -> {
                  "Columns" -> {Center, Left}, "Rows" -> {{Baseline}}}, 
                 AutoDelete -> False, 
                 GridBoxDividers -> {
                  "Columns" -> {{False}}, "Rows" -> {{False}}}, 
                 GridBoxItemSize -> {"Columns" -> {{All}}, "Rows" -> {{All}}},
                  GridBoxSpacings -> {
                  "Columns" -> {{0.5}}, "Rows" -> {{0.8}}}], "Grid"]}}, 
             GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
             AutoDelete -> False, 
             GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{1}}, "Rows" -> {{0}}}], 
            "Grid"], Alignment -> Left, AppearanceElements -> None, 
           ImageMargins -> {{5, 5}, {5, 5}}, ImageSizeAction -> 
           "ResizeToFit"], LineIndent -> 0, StripOnInput -> False], {
         FontFamily -> "Arial"}, Background -> Automatic, StripOnInput -> 
         False], TraditionalForm]& ), 
      InterpretationFunction :> (RowBox[{"PointLegend", "[", 
         RowBox[{
           RowBox[{"{", 
             RowBox[{
               RowBox[{"Directive", "[", 
                 RowBox[{
                   RowBox[{"PointSize", "[", "0.012833333333333334`", "]"}], 
                   ",", 
                   InterpretationBox[
                    ButtonBox[
                    TooltipBox[
                    GraphicsBox[{{
                    GrayLevel[0], 
                    RectangleBox[{0, 0}]}, {
                    GrayLevel[0], 
                    RectangleBox[{1, -1}]}, {
                    RGBColor[0.368417, 0.506779, 0.709798], 
                    RectangleBox[{0, -1}, {2, 1}]}}, AspectRatio -> 1, Frame -> 
                    True, FrameStyle -> 
                    RGBColor[
                    0.24561133333333335`, 0.3378526666666667, 
                    0.4731986666666667], FrameTicks -> None, PlotRangePadding -> 
                    None, ImageSize -> 
                    Dynamic[{
                    Automatic, 1.35 CurrentValue["FontCapHeight"]/
                    AbsoluteCurrentValue[Magnification]}]], 
                    "RGBColor[0.368417, 0.506779, 0.709798]"], Appearance -> 
                    None, BaseStyle -> {}, BaselinePosition -> Baseline, 
                    DefaultBaseStyle -> {}, ButtonFunction :> 
                    With[{Typeset`box$ = EvaluationBox[]}, 
                    If[
                    Not[
                    AbsoluteCurrentValue["Deployed"]], 
                    SelectionMove[Typeset`box$, All, Expression]; 
                    FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
                    FrontEnd`Private`$ColorSelectorInitialColor = 
                    RGBColor[0.368417, 0.506779, 0.709798]; 
                    FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
                    MathLink`CallFrontEnd[
                    FrontEnd`AttachCell[Typeset`box$, 
                    FrontEndResource["RGBColorValueSelector"], {
                    0, {Left, Bottom}}, {Left, Top}, 
                    "ClosingActions" -> {
                    "SelectionDeparture", "ParentChanged", 
                    "EvaluatorQuit"}]]]], BaseStyle -> Inherited, Evaluator -> 
                    Automatic, Method -> "Preemptive"], 
                    RGBColor[0.368417, 0.506779, 0.709798], Editable -> False,
                     Selectable -> False], ",", 
                   RowBox[{"AbsoluteThickness", "[", "1.6`", "]"}]}], "]"}], 
               ",", 
               RowBox[{"Directive", "[", 
                 RowBox[{
                   RowBox[{"PointSize", "[", "0.012833333333333334`", "]"}], 
                   ",", 
                   InterpretationBox[
                    ButtonBox[
                    TooltipBox[
                    GraphicsBox[{{
                    GrayLevel[0], 
                    RectangleBox[{0, 0}]}, {
                    GrayLevel[0], 
                    RectangleBox[{1, -1}]}, {
                    RGBColor[0.880722, 0.611041, 0.142051], 
                    RectangleBox[{0, -1}, {2, 1}]}}, AspectRatio -> 1, Frame -> 
                    True, FrameStyle -> 
                    RGBColor[
                    0.587148, 0.40736066666666665`, 0.09470066666666668], 
                    FrameTicks -> None, PlotRangePadding -> None, ImageSize -> 
                    Dynamic[{
                    Automatic, 1.35 CurrentValue["FontCapHeight"]/
                    AbsoluteCurrentValue[Magnification]}]], 
                    "RGBColor[0.880722, 0.611041, 0.142051]"], Appearance -> 
                    None, BaseStyle -> {}, BaselinePosition -> Baseline, 
                    DefaultBaseStyle -> {}, ButtonFunction :> 
                    With[{Typeset`box$ = EvaluationBox[]}, 
                    If[
                    Not[
                    AbsoluteCurrentValue["Deployed"]], 
                    SelectionMove[Typeset`box$, All, Expression]; 
                    FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
                    FrontEnd`Private`$ColorSelectorInitialColor = 
                    RGBColor[0.880722, 0.611041, 0.142051]; 
                    FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
                    MathLink`CallFrontEnd[
                    FrontEnd`AttachCell[Typeset`box$, 
                    FrontEndResource["RGBColorValueSelector"], {
                    0, {Left, Bottom}}, {Left, Top}, 
                    "ClosingActions" -> {
                    "SelectionDeparture", "ParentChanged", 
                    "EvaluatorQuit"}]]]], BaseStyle -> Inherited, Evaluator -> 
                    Automatic, Method -> "Preemptive"], 
                    RGBColor[0.880722, 0.611041, 0.142051], Editable -> False,
                     Selectable -> False], ",", 
                   RowBox[{"AbsoluteThickness", "[", "1.6`", "]"}]}], "]"}], 
               ",", 
               RowBox[{"Directive", "[", 
                 RowBox[{
                   RowBox[{"PointSize", "[", "0.012833333333333334`", "]"}], 
                   ",", 
                   InterpretationBox[
                    ButtonBox[
                    TooltipBox[
                    GraphicsBox[{{
                    GrayLevel[0], 
                    RectangleBox[{0, 0}]}, {
                    GrayLevel[0], 
                    RectangleBox[{1, -1}]}, {
                    RGBColor[0.560181, 0.691569, 0.194885], 
                    RectangleBox[{0, -1}, {2, 1}]}}, AspectRatio -> 1, Frame -> 
                    True, FrameStyle -> 
                    RGBColor[
                    0.37345400000000006`, 0.461046, 0.12992333333333334`], 
                    FrameTicks -> None, PlotRangePadding -> None, ImageSize -> 
                    Dynamic[{
                    Automatic, 1.35 CurrentValue["FontCapHeight"]/
                    AbsoluteCurrentValue[Magnification]}]], 
                    "RGBColor[0.560181, 0.691569, 0.194885]"], Appearance -> 
                    None, BaseStyle -> {}, BaselinePosition -> Baseline, 
                    DefaultBaseStyle -> {}, ButtonFunction :> 
                    With[{Typeset`box$ = EvaluationBox[]}, 
                    If[
                    Not[
                    AbsoluteCurrentValue["Deployed"]], 
                    SelectionMove[Typeset`box$, All, Expression]; 
                    FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
                    FrontEnd`Private`$ColorSelectorInitialColor = 
                    RGBColor[0.560181, 0.691569, 0.194885]; 
                    FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
                    MathLink`CallFrontEnd[
                    FrontEnd`AttachCell[Typeset`box$, 
                    FrontEndResource["RGBColorValueSelector"], {
                    0, {Left, Bottom}}, {Left, Top}, 
                    "ClosingActions" -> {
                    "SelectionDeparture", "ParentChanged", 
                    "EvaluatorQuit"}]]]], BaseStyle -> Inherited, Evaluator -> 
                    Automatic, Method -> "Preemptive"], 
                    RGBColor[0.560181, 0.691569, 0.194885], Editable -> False,
                     Selectable -> False], ",", 
                   RowBox[{"AbsoluteThickness", "[", "1.6`", "]"}]}], "]"}], 
               ",", 
               RowBox[{"Directive", "[", 
                 RowBox[{
                   RowBox[{"PointSize", "[", "0.012833333333333334`", "]"}], 
                   ",", 
                   InterpretationBox[
                    ButtonBox[
                    TooltipBox[
                    GraphicsBox[{{
                    GrayLevel[0], 
                    RectangleBox[{0, 0}]}, {
                    GrayLevel[0], 
                    RectangleBox[{1, -1}]}, {
                    RGBColor[0.922526, 0.385626, 0.209179], 
                    RectangleBox[{0, -1}, {2, 1}]}}, AspectRatio -> 1, Frame -> 
                    True, FrameStyle -> 
                    RGBColor[
                    0.6150173333333333, 0.25708400000000003`, 
                    0.13945266666666667`], FrameTicks -> None, 
                    PlotRangePadding -> None, ImageSize -> 
                    Dynamic[{
                    Automatic, 1.35 CurrentValue["FontCapHeight"]/
                    AbsoluteCurrentValue[Magnification]}]], 
                    "RGBColor[0.922526, 0.385626, 0.209179]"], Appearance -> 
                    None, BaseStyle -> {}, BaselinePosition -> Baseline, 
                    DefaultBaseStyle -> {}, ButtonFunction :> 
                    With[{Typeset`box$ = EvaluationBox[]}, 
                    If[
                    Not[
                    AbsoluteCurrentValue["Deployed"]], 
                    SelectionMove[Typeset`box$, All, Expression]; 
                    FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
                    FrontEnd`Private`$ColorSelectorInitialColor = 
                    RGBColor[0.922526, 0.385626, 0.209179]; 
                    FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
                    MathLink`CallFrontEnd[
                    FrontEnd`AttachCell[Typeset`box$, 
                    FrontEndResource["RGBColorValueSelector"], {
                    0, {Left, Bottom}}, {Left, Top}, 
                    "ClosingActions" -> {
                    "SelectionDeparture", "ParentChanged", 
                    "EvaluatorQuit"}]]]], BaseStyle -> Inherited, Evaluator -> 
                    Automatic, Method -> "Preemptive"], 
                    RGBColor[0.922526, 0.385626, 0.209179], Editable -> False,
                     Selectable -> False], ",", 
                   RowBox[{"AbsoluteThickness", "[", "1.6`", "]"}]}], "]"}]}],
              "}"}], ",", 
           RowBox[{"{", 
             RowBox[{#, ",", #2, ",", #3, ",", #4}], "}"}], ",", 
           RowBox[{"LegendMarkers", "\[Rule]", 
             RowBox[{"{", 
               RowBox[{
                 RowBox[{"{", 
                   RowBox[{"\"\[FilledCircle]\"", ",", "Automatic"}], "}"}], 
                 ",", 
                 RowBox[{"{", 
                   RowBox[{"\"\[FilledCircle]\"", ",", "Automatic"}], "}"}], 
                 ",", 
                 RowBox[{"{", 
                   RowBox[{"\"\[FilledCircle]\"", ",", "Automatic"}], "}"}], 
                 ",", 
                 RowBox[{"{", 
                   RowBox[{"\"\[FilledCircle]\"", ",", "Automatic"}], "}"}]}],
                "}"}]}], ",", 
           RowBox[{"Joined", "\[Rule]", 
             RowBox[{"{", 
               RowBox[{"True", ",", "True", ",", "True", ",", "True"}], 
               "}"}]}], ",", 
           RowBox[{"LabelStyle", "\[Rule]", 
             RowBox[{"{", "}"}]}], ",", 
           RowBox[{"LegendLayout", "\[Rule]", "\"Column\""}]}], "]"}]& ), 
      Editable -> True], TraditionalForm], TraditionalForm]},
  "Legended",
  DisplayFunction->(GridBox[{{
      TagBox[
       ItemBox[
        PaneBox[
         TagBox[#, "SkipImageSizeLevel"], Alignment -> {Center, Baseline}, 
         BaselinePosition -> Baseline], DefaultBaseStyle -> "Labeled"], 
       "SkipImageSizeLevel"], 
      ItemBox[#2, DefaultBaseStyle -> "LabeledLabel"]}}, 
    GridBoxAlignment -> {"Columns" -> {{Center}}, "Rows" -> {{Center}}}, 
    AutoDelete -> False, GridBoxItemSize -> Automatic, 
    BaselinePosition -> {1, 1}]& ),
  Editable->True,
  InterpretationFunction->(RowBox[{"Legended", "[", 
     RowBox[{#, ",", 
       RowBox[{"Placed", "[", 
         RowBox[{#2, ",", "After"}], "]"}]}], "]"}]& )]], "Output",
 CellChangeTimes->{{3.708934688540071*^9, 3.708934711183133*^9}, 
   3.7089348220856123`*^9, 3.708935058031639*^9, 3.70893526864465*^9, 
   3.708935305288475*^9, 3.708935973393159*^9, 3.708943052291634*^9, {
   3.708943102487117*^9, 3.708943123412068*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"kbT", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"-", "wv"}], "/", 
    RowBox[{"Log", "[", "0.36", "]"}]}], "*", 
   RowBox[{"300", "/", "0.025"}]}]}]], "Input",
 CellChangeTimes->{{3.7089389588831043`*^9, 3.708939061586977*^9}, {
  3.708939107795306*^9, 3.7089391127044992`*^9}}],

Cell[BoxData["2349.1382267654612`"], "Output",
 CellChangeTimes->{{3.708938967168735*^9, 3.708938977088492*^9}, 
   3.708939029532855*^9, 3.708939063549912*^9, 3.7089391137438993`*^9}]
}, Open  ]]
},
WindowSize->{1188, 703},
WindowMargins->{{75, Automatic}, {Automatic, 0}},
Magnification:>1.5 Inherited,
FrontEndVersion->"10.4 for Mac OS X x86 (32-bit, 64-bit Kernel) (February 25, \
2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 42302, 1085, 5335, "Input"],
Cell[CellGroupData[{
Cell[42885, 1109, 4836, 119, 519, "Input"],
Cell[CellGroupData[{
Cell[47746, 1232, 420, 8, 39, "Print"],
Cell[48169, 1242, 418, 8, 30, "Print"],
Cell[48590, 1252, 415, 8, 30, "Print"],
Cell[49008, 1262, 415, 8, 30, "Print"],
Cell[49426, 1272, 416, 8, 30, "Print"],
Cell[49845, 1282, 416, 8, 30, "Print"],
Cell[50264, 1292, 416, 8, 30, "Print"],
Cell[50683, 1302, 418, 8, 30, "Print"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[51150, 1316, 3501, 78, 416, "Input"],
Cell[54654, 1396, 46469, 979, 517, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[101160, 2380, 1132, 31, 119, "Input"],
Cell[102295, 2413, 1874, 37, 450, "Output"],
Cell[104172, 2452, 560, 12, 34, "Message"],
Cell[104735, 2466, 562, 12, 34, "Message"],
Cell[105300, 2480, 748, 14, 59, "Message"],
Cell[106051, 2496, 544, 11, 34, "Message"],
Cell[106598, 2509, 748, 14, 59, "Message"],
Cell[107349, 2525, 546, 11, 34, "Message"],
Cell[107898, 2538, 750, 14, 59, "Message"],
Cell[108651, 2554, 565, 12, 34, "Message"],
Cell[109219, 2568, 546, 11, 34, "Message"],
Cell[109768, 2581, 561, 12, 34, "Message"],
Cell[110332, 2595, 747, 14, 59, "Message"]
}, Open  ]],
Cell[CellGroupData[{
Cell[111116, 2614, 6010, 161, 818, "Input"],
Cell[CellGroupData[{
Cell[117151, 2779, 321, 6, 30, "Print"],
Cell[117475, 2787, 320, 6, 30, "Print"],
Cell[117798, 2795, 319, 6, 30, "Print"],
Cell[118120, 2803, 319, 6, 30, "Print"]
}, Open  ]],
Cell[118454, 2812, 25586, 540, 522, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[144077, 3357, 303, 8, 43, "Input"],
Cell[144383, 3367, 184, 2, 43, "Output"]
}, Open  ]]
}
]
*)

